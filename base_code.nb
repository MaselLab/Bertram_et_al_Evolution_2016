(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    131110,       2655]
NotebookOptionsPosition[    130545,       2634]
NotebookOutlinePosition[    130911,       2650]
CellTagsIndexPosition[    130868,       2647]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Definitions", " ", "of", " ", "main", " ", "simulation", " ", 
   "functions"}], "*)"}]], "Input",
 CellChangeTimes->{{3.634308216732935*^9, 3.634308266315771*^9}, {
   3.644243092315852*^9, 3.644243122262565*^9}, {3.6442494980672407`*^9, 
   3.6442495094388905`*^9}, {3.6582596556061783`*^9, 3.658259660968831*^9}, 
   3.659357519606468*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Solve", " ", "coupled", " ", "ODEs", " ", "governing", " ", "fitness", 
    " ", "class", " ", "abundances"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SolveDiffEqs", "[", 
    RowBox[{
    "r0_", ",", "\[Mu]0_", ",", "s_", ",", "K_", ",", "U_", ",", 
     "genotypeabundances_", ",", "numgenotypes_", ",", "mostfitclass_", ",", 
     "timeuntilnextenvchange_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"C", ",", "diffeqarray", ",", "X", ",", "system", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"numgenotypes", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"C", "=", 
          RowBox[{"genotypeabundances", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"system", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              SuperscriptBox["n1", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"n1", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"r0", "-", 
                RowBox[{"mostfitclass", " ", "s"}], "-", "\[Mu]0", "-", 
                FractionBox[
                 RowBox[{"r0", " ", 
                  RowBox[{"n1", "[", "t", "]"}]}], "K"]}], ")"}]}]}], ",", 
            RowBox[{
             RowBox[{"n1", "[", "0", "]"}], "\[Equal]", "C"}]}], "}"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"sol", "=", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"n1", "[", "t", "]"}], "\[Rule]", 
             FractionBox[
              RowBox[{"C", " ", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"t", " ", 
                 RowBox[{"(", 
                  RowBox[{"r0", "-", " ", 
                   RowBox[{"mostfitclass", " ", "s"}], "-", "\[Mu]0"}], 
                  ")"}]}]], " ", "K", " ", 
               RowBox[{"(", 
                RowBox[{"r0", "-", 
                 RowBox[{"mostfitclass", " ", "s"}], "-", "\[Mu]0"}], ")"}]}], 
              RowBox[{
               RowBox[{"C", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"t", " ", 
                    RowBox[{"(", 
                    RowBox[{"r0", "-", 
                    RowBox[{"mostfitclass", " ", "s"}], "-", "\[Mu]0"}], 
                    ")"}]}]]}], ")"}], " ", "r0"}], "+", 
               RowBox[{"K", " ", 
                RowBox[{"(", 
                 RowBox[{"r0", "-", 
                  RowBox[{"mostfitclass", " ", "s"}], "-", "\[Mu]0"}], 
                 ")"}]}]}]]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"diffeqarray", "=", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{"0", " ", "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"numgenotypes", ",", "numgenotypes"}], "}"}]}], "]"}]}], 
         ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"first", " ", "index", " ", "is", " ", "which", " ", 
            RowBox[{"genotype", "'"}], "s", " ", "diffeq", " ", "is", " ", 
            "solved"}], ",", " ", 
           RowBox[{
           "second", " ", "is", " ", "what", " ", "influences", " ", "it"}]}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"diffeqarray", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"r0", "-", "\[Mu]0", "-", 
              RowBox[{"s", " ", 
               RowBox[{"(", 
                RowBox[{"mostfitclass", "-", "1", "+", "i"}], ")"}]}]}]}], 
            ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"diffeqarray", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "-=", " ", 
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<n\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<[t]\>\""}], 
               "]"}], " ", 
              RowBox[{"r0", "/", "K"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numgenotypes"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "numgenotypes"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"X", "[", "t_", "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<n\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<[t]\>\""}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", "numgenotypes", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"system", " ", "=", " ", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Equal]", "#2"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"X", "[", "t", "]"}], ",", "t"}], "]"}], ",", 
                RowBox[{"diffeqarray", ".", 
                 RowBox[{"X", "[", "t", "]"}]}]}], "}"}]}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{"see", " ", 
              RowBox[{"tutorial", "/", "DSolveSystemsOfLinearODEs"}]}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Equal]", "#2"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"X", "[", "t", "]"}], "/.", 
                 RowBox[{"t", "\[Rule]", "0"}]}], ",", "genotypeabundances"}],
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sol", "=", 
          RowBox[{"NDSolve", "[", 
           RowBox[{"system", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<n\>\"", "<>", 
                RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<[t]\>\""}], 
               "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", "numgenotypes", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "timeuntilnextenvchange"}], "}"}]}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"system", ",", "sol"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5246095996360774`*^9, 3.5246096152142024`*^9}, {
   3.5246096742142024`*^9, 3.5246096817454524`*^9}, {3.5246097203079524`*^9, 
   3.5246098370892024`*^9}, {3.5246098739954524`*^9, 
   3.5246098857298274`*^9}, {3.5246694253125*^9, 3.5246695780625*^9}, {
   3.532781382234375*^9, 3.5327813964375*^9}, {3.5327816995*^9, 
   3.532781703578125*^9}, {3.532781758859375*^9, 3.532781777734375*^9}, {
   3.532781815984375*^9, 3.532781822234375*^9}, 3.532781852671875*^9, {
   3.532782004328125*^9, 3.532782011609375*^9}, {3.532782077125*^9, 
   3.53278213703125*^9}, {3.53280043028125*^9, 3.53280043253125*^9}, {
   3.54055894603125*^9, 3.540558952234375*^9}, 3.634308098931197*^9, {
   3.6343081464889174`*^9, 3.6343081682421618`*^9}, 3.634308207076383*^9, {
   3.6350721864634438`*^9, 3.6350721926787996`*^9}, {3.635072230243948*^9, 
   3.6350722319760475`*^9}, {3.6350723981945543`*^9, 
   3.6350724024547977`*^9}, {3.6350749450482264`*^9, 
   3.6350749494454775`*^9}, {3.635088057513216*^9, 3.6350880650366464`*^9}, {
   3.63508810811111*^9, 3.635088108144112*^9}, {3.635088154473762*^9, 
   3.635088161327154*^9}, {3.6350882419897676`*^9, 3.6350882422657833`*^9}, {
   3.6350883702851057`*^9, 3.6350883805666933`*^9}, {3.635088420375971*^9, 
   3.635088430236535*^9}, {3.635088619067335*^9, 3.6350886208484373`*^9}, {
   3.6350887926442633`*^9, 3.635088829631379*^9}, {3.6350888666934986`*^9, 
   3.6350888745369473`*^9}, {3.63508897249255*^9, 3.635088978679904*^9}, {
   3.635089100249857*^9, 3.635089107623279*^9}, {3.6350895727038803`*^9, 
   3.635089574601989*^9}, {3.6350896237037973`*^9, 3.6350896458150616`*^9}, {
   3.6350897617756944`*^9, 3.6350897713252406`*^9}, {3.635089806946278*^9, 
   3.6350898072762966`*^9}, {3.6350912848708105`*^9, 3.635091302290807*^9}, {
   3.635091462826989*^9, 3.6350914801289787`*^9}, {3.635091518212157*^9, 
   3.635091519947256*^9}, {3.635091555459287*^9, 3.6350915585804653`*^9}, {
   3.635091603903058*^9, 3.6350916043950863`*^9}, {3.635091654172933*^9, 
   3.635091654497952*^9}, {3.635091726287058*^9, 3.6350917311793375`*^9}, {
   3.635091770747601*^9, 3.6350917709276114`*^9}, {3.6350918019843874`*^9, 
   3.6350918177422886`*^9}, {3.635091866470076*^9, 3.6350918666270847`*^9}, {
   3.6350919587593546`*^9, 3.635091959260383*^9}, {3.6350919946664085`*^9, 
   3.6350920319475408`*^9}, {3.6350921008854837`*^9, 
   3.6350921150652947`*^9}, {3.63509214976328*^9, 3.635092155912631*^9}, {
   3.6350927502506256`*^9, 3.6350927586791077`*^9}, {3.6350960628247147`*^9, 
   3.6350960671569624`*^9}, {3.6350963036804905`*^9, 
   3.6350963064086466`*^9}, {3.635097599755622*^9, 3.6350976088691435`*^9}, 
   3.635097730018072*^9, {3.635098053401569*^9, 3.6350980551456685`*^9}, {
   3.6350987165454984`*^9, 3.6350987175955586`*^9}, {3.6350993340778193`*^9, 
   3.635099334414839*^9}, {3.6351068928331556`*^9, 3.6351069544826813`*^9}, {
   3.6351070788217936`*^9, 3.6351071155858965`*^9}, {3.6351139051419787`*^9, 
   3.6351139132154408`*^9}, {3.63511415780143*^9, 3.6351141645028133`*^9}, {
   3.6351780701998835`*^9, 3.6351780823025756`*^9}, {3.6351781598000083`*^9, 
   3.6351781671164265`*^9}, {3.6351782484770803`*^9, 
   3.6351782775937457`*^9}, {3.635178645961815*^9, 3.635178647421899*^9}, 
   3.635178679810751*^9, {3.6351788698796225`*^9, 3.635178870217642*^9}, {
   3.6351790230863857`*^9, 3.635179032044898*^9}, {3.6351796345453587`*^9, 
   3.635179647595105*^9}, {3.635179899381507*^9, 3.6351798995155144`*^9}, {
   3.6351801784034657`*^9, 3.635180187081962*^9}, {3.6351805977224493`*^9, 
   3.63518059790546*^9}, {3.6351807152291703`*^9, 3.6351807197734303`*^9}, {
   3.6351814153522153`*^9, 3.635181417868359*^9}, {3.6351814671371775`*^9, 
   3.635181467627205*^9}, {3.635182014836504*^9, 3.6351820179766836`*^9}, {
   3.635182098155269*^9, 3.6351821122650766`*^9}, {3.635182257046357*^9, 
   3.6351822770064993`*^9}, {3.6351823118884945`*^9, 3.635182311957498*^9}, {
   3.635182875431727*^9, 3.6351828820441055`*^9}, {3.635183023439193*^9, 
   3.635183024002225*^9}, {3.635183126045061*^9, 3.63518313318147*^9}, {
   3.6351839130160737`*^9, 3.635183916712285*^9}, {3.6351840002730646`*^9, 
   3.63518400054708*^9}, {3.635184093174378*^9, 3.6351841009808245`*^9}, {
   3.6351841885148315`*^9, 3.6351841987514167`*^9}, {3.6351843549543505`*^9, 
   3.6351843550853586`*^9}, {3.6351844335168447`*^9, 
   3.6351844408212624`*^9}, {3.635184722586378*^9, 3.635184722722386*^9}, {
   3.6351852885447493`*^9, 3.635185288611753*^9}, {3.635185643210035*^9, 
   3.63518565221455*^9}, {3.6351857259157653`*^9, 3.635185730004999*^9}, {
   3.6351858502088747`*^9, 3.6351858674808626`*^9}, {3.635185974587989*^9, 
   3.6351859762810855`*^9}, {3.635186410075897*^9, 3.6351864531063585`*^9}, {
   3.6351864865712724`*^9, 3.6351864945237274`*^9}, {3.635186585380924*^9, 
   3.635186585612937*^9}, 3.6351869045331783`*^9, {3.6351869759272623`*^9, 
   3.6351869817155933`*^9}, {3.635187066708454*^9, 3.6351871194064684`*^9}, {
   3.6351872042213197`*^9, 3.6351872075155077`*^9}, {3.6351873305065427`*^9, 
   3.635187387246788*^9}, {3.6351874474142294`*^9, 3.6351874493003373`*^9}, {
   3.635187520466408*^9, 3.635187522147504*^9}, {3.63518759341658*^9, 
   3.6351875955157003`*^9}, {3.635187652371952*^9, 3.6351876697729473`*^9}, {
   3.63518776229924*^9, 3.6351877661964626`*^9}, {3.635187825123833*^9, 
   3.635187829134063*^9}, {3.6351878713704786`*^9, 3.635187884932254*^9}, {
   3.6355197858663244`*^9, 3.635519786159341*^9}, {3.6442494997403364`*^9, 
   3.6442495002353644`*^9}, {3.658259670995079*^9, 3.658259712382492*^9}, 
   3.659357519606566*^9, 3.664586129316842*^9, {3.674225383942503*^9, 
   3.674225420330544*^9}, {3.674225845881777*^9, 3.674225846522703*^9}, {
   3.6742273320250053`*^9, 3.6742273369872417`*^9}, {3.6742285261702223`*^9, 
   3.6742285282660723`*^9}, {3.674229311445553*^9, 3.674229314513915*^9}, {
   3.6743014926296053`*^9, 3.6743014940427427`*^9}, {3.674301567525618*^9, 
   3.67430156985935*^9}, {3.678125066904793*^9, 3.6781251008978*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "time", " ", "to", " ", "next", " ", "mutation"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NextMutation", "[", 
    RowBox[{
    "U_", ",", "bestclassbirths_", ",", "starttime_", ",", 
     "timeuntilnextenvchange_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numreplications", ",", "F", ",", "guessedtime1", ",", "guessedtime2", 
       ",", "guessedtimetemp", ",", "F1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numreplications", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"ExponentialDistribution", "[", "1", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"F", "=", 
       RowBox[{"NDSolveValue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"y", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"U", " ", 
             RowBox[{"bestclassbirths", "[", "t", "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"y", "[", "starttime", "]"}], "\[Equal]", "0"}]}], "}"}], 
         ",", "y", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "starttime", ",", "timeuntilnextenvchange"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Sometimes", " ", "when", " ", "pop", " ", "is", " ", "declining"}], 
        ",", " ", 
        RowBox[{
         RowBox[{"no", " ", 
          RowBox[{"F", "[", "t", "]"}], " ", "will", " ", "ever", " ", "be", 
          " ", "high", " ", "enough"}], ";", " ", 
         RowBox[{"check", " ", "for", " ", "this"}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "[", "timeuntilnextenvchange", "]"}], "<", 
         "numreplications"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", "veryverbose", ")"}], ",", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Next mutation not estimated before \>\"", ",", 
              "timeuntilnextenvchange", ",", "\"\<, starting at \>\"", ",", 
              "starttime"}], "]"}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"timeuntilnextenvchange", "+", "1"}]}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"mutationtime", "/.", "\[IndentingNewLine]", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", "mutationtime", "]"}], "\[Equal]", 
            "numreplications"}], " ", ",", 
           RowBox[{"{", 
            RowBox[{
            "mutationtime", ",", "starttime", ",", "timeuntilnextenvchange"}],
             "}"}], ",", 
           RowBox[{"Method", "->", "\"\<Brent\>\""}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5245162531772647`*^9, 3.5245162791774263`*^9}, {
   3.524516461231696*^9, 3.524516596603982*^9}, {3.524516718200782*^9, 
   3.5245167221388865`*^9}, {3.524581465890625*^9, 3.5245815205625*^9}, {
   3.524581849953125*^9, 3.524581854046875*^9}, {3.524582020890625*^9, 
   3.524582022078125*^9}, {3.52458205925*^9, 3.524582120515625*^9}, {
   3.5245821954375*^9, 3.524582202453125*^9}, {3.5245917529375*^9, 
   3.5245917945625*^9}, {3.5245958254798274`*^9, 3.5245958386204524`*^9}, {
   3.5245958893860774`*^9, 3.5245958918704524`*^9}, {3.5245959331517024`*^9, 
   3.5245959343704524`*^9}, {3.5245959703235774`*^9, 
   3.5245959704798274`*^9}, {3.5245960120267024`*^9, 
   3.5245960311985774`*^9}, {3.5245961793079524`*^9, 
   3.5245962117298274`*^9}, {3.5245962509017024`*^9, 
   3.5245962543860774`*^9}, {3.5245975038079524`*^9, 
   3.5245975731048274`*^9}, {3.5245976043079524`*^9, 
   3.5245976090892024`*^9}, {3.5245976413548274`*^9, 
   3.5245977088235774`*^9}, {3.5245978109485774`*^9, 
   3.5245978148235774`*^9}, {3.5245980265735774`*^9, 3.5245981870267024`*^9}, 
   3.5245982261360774`*^9, {3.5245983439954524`*^9, 3.5245983503860774`*^9}, {
   3.5245989262610774`*^9, 3.5245989287454524`*^9}, {3.5245989587610774`*^9, 
   3.5245989654485774`*^9}, {3.5245990726048274`*^9, 
   3.5245990842610774`*^9}, {3.5246090809954524`*^9, 3.5246090839173274`*^9}, 
   3.5246092036985774`*^9, 3.5246095483704524`*^9, {3.531245672890625*^9, 
   3.53124575459375*^9}, {3.531251271828125*^9, 3.531251320265625*^9}, {
   3.531251429453125*^9, 3.53125145871875*^9}, {3.531251547359375*^9, 
   3.53125156865625*^9}, {3.531251625984375*^9, 3.53125162965625*^9}, {
   3.53125168759375*^9, 3.531251690203125*^9}, {3.53125807340625*^9, 
   3.531258076453125*^9}, {3.5317739185*^9, 3.53177392434375*^9}, {
   3.532800526890625*^9, 3.532800581046875*^9}, {3.532876951609375*^9, 
   3.532876993109375*^9}, {3.532877029890625*^9, 3.532877164046875*^9}, {
   3.532877282796875*^9, 3.53287736334375*^9}, {3.5328774665*^9, 
   3.532877472046875*^9}, {3.5328805380625*^9, 3.532880559484375*^9}, {
   3.532880662421875*^9, 3.5328808483125*^9}, {3.532881154625*^9, 
   3.532881178515625*^9}, {3.53288147971875*^9, 3.532881564203125*^9}, {
   3.532881596796875*^9, 3.532881625875*^9}, {3.532881682921875*^9, 
   3.532881715625*^9}, 3.53288174765625*^9, {3.532881911875*^9, 
   3.532881921625*^9}, 3.532881994609375*^9, {3.532882249453125*^9, 
   3.532882267328125*^9}, {3.532882856671875*^9, 3.532882863109375*^9}, {
   3.532882952171875*^9, 3.532882971921875*^9}, {3.53288361634375*^9, 
   3.53288364665625*^9}, {3.532883881875*^9, 3.53288401009375*^9}, {
   3.532884101421875*^9, 3.5328841066875*^9}, {3.53288448621875*^9, 
   3.532884523140625*^9}, {3.532884670296875*^9, 3.53288471578125*^9}, {
   3.532892522828125*^9, 3.53289253709375*^9}, {3.5328926011875*^9, 
   3.532892620453125*^9}, {3.53289547359375*^9, 3.532895474703125*^9}, {
   3.5401240068125*^9, 3.540124006828125*^9}, {3.5402191719375*^9, 
   3.540219209375*^9}, {3.540220495890625*^9, 3.54022050034375*^9}, {
   3.540222595140625*^9, 3.540222604859375*^9}, {3.540222749265625*^9, 
   3.54022280071875*^9}, {3.5402358691875*^9, 3.54023593678125*^9}, {
   3.540235993328125*^9, 3.540236106390625*^9}, {3.5402361474375*^9, 
   3.5402361534375*^9}, {3.540236199015625*^9, 3.54023626475*^9}, {
   3.540236296140625*^9, 3.5402363035625*^9}, {3.540558217609375*^9, 
   3.540558237390625*^9}, {3.540561439890625*^9, 3.540561449765625*^9}, {
   3.540757297828125*^9, 3.54075731534375*^9}, {3.540817443734375*^9, 
   3.5408174646875*^9}, {3.54081754178125*^9, 3.540817586234375*^9}, {
   3.540817645515625*^9, 3.54081769834375*^9}, {3.540817840515625*^9, 
   3.540817853359375*^9}, {3.5408178850625*^9, 3.540817887359375*^9}, {
   3.54081794865625*^9, 3.5408179661875*^9}, {3.5408181983125*^9, 
   3.540818222734375*^9}, {3.5408184654375*^9, 3.54081852646875*^9}, {
   3.54081856075*^9, 3.5408185745*^9}, {3.54081863021875*^9, 
   3.5408186415*^9}, {3.540818672*^9, 3.54081869365625*^9}, {
   3.540818755734375*^9, 3.54081876578125*^9}, {3.540819334390625*^9, 
   3.5408193608125*^9}, {3.54082188490625*^9, 3.5408219038125*^9}, {
   3.54082193965625*^9, 3.54082203109375*^9}, {3.540827880015625*^9, 
   3.54082794971875*^9}, {3.54082800278125*^9, 3.5408281025625*^9}, {
   3.540828144453125*^9, 3.5408284086875*^9}, {3.540828451421875*^9, 
   3.5408284609375*^9}, {3.54082851675*^9, 3.5408285175625*^9}, {
   3.54083390565625*^9, 3.540833971625*^9}, 3.634308098931197*^9, {
   3.6343081464889174`*^9, 3.634308168243162*^9}, {3.634854951968799*^9, 
   3.6348549541389236`*^9}, {3.634855861405816*^9, 3.6348558935796566`*^9}, {
   3.634856481647292*^9, 3.634856505094633*^9}, {3.6349193502145834`*^9, 
   3.6349193507076116`*^9}, {3.6349194434009132`*^9, 3.634919446364083*^9}, 
   3.6349194871854177`*^9, {3.634919570118161*^9, 3.634919581230797*^9}, {
   3.634919657045133*^9, 3.634919664821578*^9}, {3.63492124904219*^9, 
   3.634921252110366*^9}, {3.634944914224763*^9, 3.634944923005265*^9}, {
   3.6349449792534823`*^9, 3.6349449860568714`*^9}, {3.635005432255288*^9, 
   3.6350054360895076`*^9}, {3.6350099865777807`*^9, 
   3.6350099899669743`*^9}, {3.635010376476082*^9, 3.6350103792412395`*^9}, {
   3.6351055064038563`*^9, 3.6351055067288747`*^9}, {3.6351322289630413`*^9, 
   3.6351322753636956`*^9}, {3.6351738654633865`*^9, 3.635173874583908*^9}, {
   3.6351776658717575`*^9, 3.635177665939761*^9}, {3.641413098315462*^9, 
   3.6414131016966553`*^9}, 3.6421659273032765`*^9, {3.6582601620679817`*^9, 
   3.6582601964001017`*^9}, {3.658260235173861*^9, 3.6582602354366837`*^9}, {
   3.65826027812988*^9, 3.658260300030651*^9}, {3.658494059539296*^9, 
   3.658494061185502*^9}, 3.659357519606637*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Fixation", " ", "probability"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CalcPfix", "[", 
     RowBox[{
     "r0_", ",", "\[Mu]0_", ",", "s_", ",", "K_", ",", "mutationtime_", ",", 
      "popsize_", ",", "i_", ",", "q_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Analytical", " ", "fixation", " ", "probability", " ", "assuming", 
        " ", "constant", " ", "N", " ", "and", " ", "no", " ", "env", " ", 
        "change"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r0", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox["popsize", "K"]}], ")"}]}], ">", 
         RowBox[{
          RowBox[{"i", " ", "s"}], "+", "\[Mu]0"}]}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"popsize", " ", "r0"}], "+", 
           RowBox[{"K", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "r0"}], "+", 
              RowBox[{"i", " ", "s"}], "+", "\[Mu]0"}], ")"}]}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"K", "-", "popsize"}], ")"}], " ", "r0"}]]}], 
        "\[IndentingNewLine]", ",", "0"}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Analytical", " ", "fixation", " ", "probability", " ", "using", " ", 
     "averaged", " ", "N"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CalcPfix2", "[", 
     RowBox[{
     "r0_", ",", "\[Mu]0_", ",", "s_", ",", "K_", ",", "mutationtime_", ",", 
      "timeuntilnextenvchange_", ",", "totalpopsize_", ",", "i_", ",", "q_"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "popsize"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"popsize", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"totalpopsize", ",", 
           RowBox[{"Subdivide", "[", 
            RowBox[{"mutationtime", ",", 
             RowBox[{"Min", "[", 
              RowBox[{"timeuntilnextenvchange", ",", 
               RowBox[{"mutationtime", "+", 
                RowBox[{"q", " ", "s"}]}]}], "]"}], ",", "100"}], "]"}]}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"r0", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox["popsize", "K"]}], ")"}]}], ">", 
          RowBox[{
           RowBox[{"i", " ", "s"}], "+", "\[Mu]0"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"popsize", " ", "r0"}], "+", 
            RowBox[{"K", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "r0"}], "+", 
               RowBox[{"i", " ", "s"}], "+", "\[Mu]0"}], ")"}]}]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"K", "-", "popsize"}], ")"}], " ", "r0"}]]}], 
         "\[IndentingNewLine]", ",", "0"}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Full", " ", "numerical", " ", "integration", " ", "over", " ", 
     "remainder", " ", "of", " ", "current", " ", "interval", " ", "followed",
      " ", "by", " ", "timebetweenenvchanges", " ", "after", " ", 
     RowBox[{"change", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CalcPfix3", "[", 
     RowBox[{
     "r0_", ",", "\[Mu]0_", ",", "s_", ",", "K_", ",", "mutationtime_", ",", 
      "timeuntilnextenvchange_", ",", "totalpopsize_", ",", "i_", ",", 
      "totalpopsizeafter_", ",", "timebetweenenvchanges_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "G", ",", "popsize", ",", "popsizeatchange"}], "}"}],
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"F", "=", 
        RowBox[{"NDSolveValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"y", "'"}], "[", "\[Tau]", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"r0", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"totalpopsize", "[", "\[Tau]", "]"}], "/", "K"}]}], 
                ")"}]}], "-", "\[Mu]0", "-", 
              RowBox[{"s", " ", "i"}]}]}], ",", 
            RowBox[{
             RowBox[{"y", "[", "mutationtime", "]"}], "\[Equal]", "0"}]}], 
           "}"}], ",", "y", ",", 
          RowBox[{"{", 
           RowBox[{
           "\[Tau]", ",", "mutationtime", ",", "timeuntilnextenvchange"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"G", "=", 
        RowBox[{"NDSolveValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"y", "'"}], "[", "\[Tau]", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"r0", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"totalpopsizeafter", "[", "\[Tau]", "]"}], "/", 
                  "K"}]}], ")"}]}], "-", "\[Mu]0", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "s"}]}]}], " ", ",", 
            RowBox[{
             RowBox[{"y", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"F", "[", "timeuntilnextenvchange", "]"}]}]}], "}"}], 
          ",", "y", ",", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", "0", ",", "timebetweenenvchanges"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"2", "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"r0", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"totalpopsize", "[", "t", "]"}], "/", "K"}]}], 
                 ")"}]}], "+", "\[Mu]0", "+", 
               RowBox[{"s", " ", "i"}]}], ")"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"F", "[", "t", "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
             "t", ",", "mutationtime", ",", "timeuntilnextenvchange"}], 
             "}"}]}], "]"}], "+", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"r0", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"totalpopsizeafter", "[", "t", "]"}], "/", "K"}]}],
                  ")"}]}], "+", "\[Mu]0", "+", 
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}]}]}], ")"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"G", "[", "t", "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "timebetweenenvchanges"}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.6433963029212875`*^9, 3.643396303964347*^9}, 
   3.6433963928574314`*^9, {3.643397011067791*^9, 3.643397052272148*^9}, 
   3.658260202795792*^9, {3.658260321698737*^9, 3.658260342359684*^9}, 
   3.6593575196067047`*^9, {3.6593799781824713`*^9, 3.659380013303062*^9}, {
   3.659380401109899*^9, 3.659380407149775*^9}, {3.659380549594687*^9, 
   3.659380556055256*^9}, {3.659380662185565*^9, 3.659380668625708*^9}, 
   3.659381590630258*^9, {3.659381621878663*^9, 3.6593816228458138`*^9}, {
   3.659381798703782*^9, 3.659381801122719*^9}, {3.659381840654212*^9, 
   3.659381844336317*^9}, 3.659385043596918*^9, {3.659385278672112*^9, 
   3.659385281336136*^9}, {3.659385659646274*^9, 3.6593856616693983`*^9}, 
   3.6593858156878347`*^9, {3.6593864994487677`*^9, 3.659386499591949*^9}, {
   3.659388202220945*^9, 3.659388205871407*^9}, {3.659388317409442*^9, 
   3.659388327729501*^9}, {3.659389432390753*^9, 3.659389456855391*^9}, {
   3.659391202381497*^9, 3.6593912065253897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Initial", " ", "populaion", " ", "size", " ", "for", " ", "deterministic",
     " ", "growth", " ", "after", " ", "establishment"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CalcEstablishmentTime", "[", "pfix_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ran", ",", "v0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ran", "=", 
       RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v0", "=", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", "ran"}], "]"}], "pfix"]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ran", ",", "v0"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5336539685*^9, 3.533654073125*^9}, {3.5336541335*^9, 
   3.533654140640625*^9}, {3.53365420871875*^9, 3.533654226328125*^9}, {
   3.533654367078125*^9, 3.533654449703125*^9}, {3.533655005*^9, 
   3.533655005328125*^9}, 3.533662273015625*^9, 3.634308098940198*^9, 
   3.634308168243162*^9, {3.6583324690410547`*^9, 3.658332494569017*^9}, 
   3.659357519606781*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PruneUnfitClasses", "[", 
   RowBox[{"numgenotypes_", ",", "genotypeabundances_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "newnumgenotypes", ",", "newgenotypeabundances"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"i", "=", "numgenotypes"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newnumgenotypes", "=", "numgenotypes"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"genotypeabundances", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "<", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "=", 
           RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"(", "verbose", ")"}], ",", 
               RowBox[{
                RowBox[{
                "Print", "[", "\"\<WARNING: population extinction\>\"", "]"}],
                 ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"newgenotypeabundances", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"newnumgenotypes", "=", "0"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "<", "numgenotypes"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"(", "veryverbose", ")"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Drop \>\"", ",", 
                  RowBox[{"numgenotypes", "-", "i"}], ",", 
                  "\"\< unfit genotype class(es) from \>\"", ",", 
                  "genotypeabundances"}], "]"}], ";"}]}], "]"}], ";"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"newgenotypeabundances", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"genotypeabundances", ",", 
             RowBox[{"i", "-", "numgenotypes"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newnumgenotypes", "=", "i"}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", "=", "0"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newnumgenotypes", ",", "newgenotypeabundances"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5327987325625*^9, 3.53279878440625*^9}, {
   3.53279883225*^9, 3.532799218265625*^9}, 3.532799318890625*^9, 
   3.532799493234375*^9, {3.532799665796875*^9, 3.5327997643125*^9}, {
   3.532799820078125*^9, 3.532799853203125*^9}, {3.53279992921875*^9, 
   3.532799980140625*^9}, {3.53289683884375*^9, 3.53289684015625*^9}, {
   3.54012533690625*^9, 3.5401253518125*^9}, {3.540739342140625*^9, 
   3.54073934253125*^9}, 3.6343080989481983`*^9, 3.634308168244162*^9, {
   3.659297242196486*^9, 3.659297243827331*^9}, 3.659357519606844*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RunSimulationCheckEachMutation2", "[", 
   RowBox[{
   "r0_", ",", "\[Mu]0_", ",", "s_", ",", "K_", ",", "U_", ",", "maxtime_", 
    ",", "timebetweenenvchanges_", ",", "initmostfitclass_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "genotypeabundances", ",", "globaltime", ",", "numgenotypes", ",", 
      "system", ",", "sol", ",", "solafter", ",", "totalpopsize", ",", 
      "totalpopsizeafter", ",", "bestclasssize", ",", "bestclassbirths", ",", 
      "mutationtime", ",", "pfix", ",", "v0", ",", "establishtimeran", ",", 
      "fixation", ",", "fixationran", ",", "timeuntilnextenvchange", ",", 
      "lastenvwaittime", ",", "oldtotalpopsize", ",", "q", ",", "extinct", 
      ",", "mostfitclass", ",", "history", ",", "esttime", ",", "qest"}], 
     "}"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"ivals", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"qvals", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Weird", " ", "context", " ", "conflicts", " ", "were", " ", "occuring",
        " ", "when", " ", "using", " ", "Parallel", " ", "unless", " ", 
       "these", " ", "symbols", " ", "have", " ", "already", " ", "been", " ", 
       RowBox[{"used", ".", " ", "Ideally"}], " ", "should", " ", "not", " ", 
       "be", " ", 
       RowBox[{"here", "!"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "n1", ",", "n2", ",", "n3", ",", "n4", ",", "n5", ",", "n6", ",", "n7", 
       ",", "n8", ",", "n9", ",", "n10", ",", "n11", ",", "n12", ",", "n13", 
       ",", "n14", ",", "n15", ",", "n16", ",", "n17", ",", "n18", ",", "n19",
        ",", "n20", ",", "n21", ",", "n22", ",", "n23", ",", "n24", ",", 
       "n25", ",", "n26", ",", "n27", ",", "n28", ",", "n29", ",", "n30", ",",
        "n31", ",", "n32", ",", "n33", ",", "n34", ",", "n35", ",", "n36", 
       ",", "n37", ",", "n38", ",", "n39", ",", "n40", ",", "n41", ",", "n42",
        ",", "n43", ",", "n44", ",", "n45", ",", "n46", ",", "n47", ",", 
       "n48", ",", "n49", ",", "n50", ",", "n51", ",", "n52", ",", "n53", ",",
        "n54", ",", "n55", ",", "n56", ",", "n57", ",", "n58", ",", "n59", 
       ",", "n60", ",", "n61", ",", "n62", ",", "n63", ",", "n64", ",", "n65",
        ",", "n66", ",", "n67", ",", "n68", ",", "n69", ",", "n70", ",", 
       "n71", ",", "n72", ",", "n73", ",", "n74", ",", "n75", ",", "n76", ",",
        "n77", ",", "n78", ",", "n79", ",", "n80", ",", "n81", ",", "n82", 
       ",", "n83", ",", "n84", ",", "n85", ",", "n86", ",", "n87", ",", "n88",
        ",", "n89", ",", "n90", ",", "n91", ",", "n92", ",", "n93", ",", 
       "n94", ",", "n95", ",", "n96", ",", "n97", ",", "n98", ",", "n99", ",",
        "n100"}], "}"}], ";", "\[IndentingNewLine]", 
     RowBox[{"mostfitclass", "=", "initmostfitclass"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"K", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r", "-", "\[Mu]", "-", 
                RowBox[{"i", " ", "s"}]}], ")"}], "/", "r"}], " ", 
             RowBox[{"(", 
              RowBox[{"\[Mu]", "+", 
               RowBox[{"i", " ", "s"}]}], ")"}], " ", "U", " ", "i", " ", 
             RowBox[{"Log", "[", " ", 
              RowBox[{"K", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"r", "-", "\[Mu]", "-", 
                  RowBox[{"i", " ", "s"}]}], ")"}], "/", "r"}], " ", "s"}], 
              "]"}]}], "/.", 
            RowBox[{"i", "\[Rule]", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r0", "-", "\[Mu]0"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", "s"}], ")"}]}]}]}], ")"}], ">", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"multiple", " ", "mutations", " ", "regime"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"esttime", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", 
                  RowBox[{"Log", "[", " ", 
                   RowBox[{
                    RowBox[{"K", "/", "r"}], 
                    RowBox[{"(", 
                    RowBox[{"r", "-", 
                    RowBox[{"i", " ", "s"}], "-", "\[Mu]"}], ")"}], " ", 
                    "s"}], "]"}]}], "-", 
                 RowBox[{"Log", "[", 
                  RowBox[{"s", "/", 
                   RowBox[{"(", 
                    RowBox[{"U", " ", "i"}], ")"}]}], "]"}]}], ")"}], 
               RowBox[{"s", "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Log", "[", 
                   RowBox[{"s", "/", 
                    RowBox[{"(", 
                    RowBox[{"U", " ", "i"}], ")"}]}], "]"}], ")"}], "^", 
                 "2"}]}]}], ")"}], "^", 
             RowBox[{"-", "1"}]}], " ", "/.", 
            RowBox[{"i", "\[Rule]", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r0", "-", "\[Mu]0"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", "s"}], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"qest", "=", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{
               RowBox[{"Log", "[", " ", 
                RowBox[{"K", 
                 RowBox[{"(", 
                  RowBox[{"r", "-", "\[Mu]", "-", 
                   RowBox[{"i", " ", "s"}]}], ")"}], " ", 
                 RowBox[{"s", "/", "r"}]}], "]"}], "/", 
               RowBox[{"Log", "[", 
                RowBox[{"s", "/", 
                 RowBox[{"(", 
                  RowBox[{"U", " ", "i"}], ")"}]}], "]"}]}]}], "/.", 
             RowBox[{"i", "\[Rule]", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r0", "-", "\[Mu]0"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", "s"}], ")"}]}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"genotypeabundances", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "esttime"}], "*", 
               RowBox[{"Abs", "[", 
                RowBox[{"i", " ", "s"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "qest"}], ",", "qest"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"genotypeabundances", "=", 
           RowBox[{
            FractionBox[
             RowBox[{"K", " ", 
              RowBox[{"(", 
               RowBox[{"r0", "-", "\[Mu]0", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"mostfitclass", "+", "qest"}], ")"}], " ", "s"}]}], 
               ")"}]}], "r0"], 
            RowBox[{"genotypeabundances", "/", 
             RowBox[{"Total", "[", "genotypeabundances", "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"numgenotypes", "=", 
           RowBox[{"Length", "[", "genotypeabundances", "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"successional", " ", "regime"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"genotypeabundances", "=", 
           RowBox[{"{", 
            FractionBox[
             RowBox[{"K", " ", 
              RowBox[{"(", 
               RowBox[{"r0", "-", "\[Mu]0", "-", 
                RowBox[{"mostfitclass", " ", "s"}]}], ")"}]}], "r0"], "}"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"numgenotypes", "=", "1"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"genotypeabundances", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"K", " ", 
           RowBox[{"(", 
            RowBox[{"r0", "-", "\[Mu]0", "-", 
             RowBox[{"mostfitclass", " ", "s"}]}], ")"}]}], "r0"], "/", "4"}],
         ",", 
        RowBox[{
         FractionBox[
          RowBox[{"K", " ", 
           RowBox[{"(", 
            RowBox[{"r0", "-", "\[Mu]0", "-", 
             RowBox[{"mostfitclass", " ", "s"}]}], ")"}]}], "r0"], "/", "2"}],
         ",", 
        RowBox[{
         FractionBox[
          RowBox[{"K", " ", 
           RowBox[{"(", 
            RowBox[{"r0", "-", "\[Mu]0", "-", 
             RowBox[{"mostfitclass", " ", "s"}]}], ")"}]}], "r0"], "/", 
         "4"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numgenotypes", "=", "3"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"globaltime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"timeuntilnextenvchange", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"ExponentialDistribution", "[", 
        RowBox[{"1", "/", "timebetweenenvchanges"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fixation", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"extinct", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"history", "=", 
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"globaltime", "<", "maxtime"}], " ", "&&", " ", 
           RowBox[{"(", 
            RowBox[{"!", "extinct"}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", "verbose", ")"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<step starting at time=\>\"", ",", "globaltime", ",", 
                "\"\< with mostfitclass=\>\"", ",", "mostfitclass", ",", 
                "\"\< genotypeabundances=\>\"", ",", "genotypeabundances"}], 
               "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"system", ",", "sol"}], "}"}], "=", 
            RowBox[{"SolveDiffEqs", "[", 
             RowBox[{
             "r0", ",", "\[Mu]0", ",", "s", ",", "K", ",", "U", ",", 
              "genotypeabundances", ",", "numgenotypes", ",", "mostfitclass", 
              ",", "timeuntilnextenvchange"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fixation", "=", "False"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mostfitclass", ">", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"totalpopsize", "=", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ToExpression", "[", 
                   RowBox[{"\"\<n\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}], "<>", 
                    "\"\<[t]\>\""}], "]"}], "/.", 
                  RowBox[{"sol", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"bestclasssize", "=", 
               RowBox[{
                RowBox[{"ToExpression", "[", "\"\<n1[t]\>\"", "]"}], " ", "/.", 
                RowBox[{"sol", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"bestclassbirths", "=", 
               RowBox[{"Simplify", "[", 
                RowBox[{
                 RowBox[{"bestclasssize", " ", "r0", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"totalpopsize", "/", "K"}]}], ")"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"t", ">", "0"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"pfix", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"mutationtime", "=", "0"}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"While", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"!", "fixation"}], ")"}], "&&", " ", 
                 RowBox[{"mutationtime", "<", "timeuntilnextenvchange"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"mutationtime", "=", 
                  RowBox[{"NextMutation", "[", 
                   RowBox[{
                    RowBox[{"U", " ", "mostfitclass"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"bestclassbirths", "/.", 
                    RowBox[{"t", "\[Rule]", "#"}]}], ")"}], " ", "&"}], ",", 
                    "mutationtime", ",", "timeuntilnextenvchange"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"(", "veryverbose", ")"}], ",", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<mutation at local time \>\"", ",", "mutationtime", 
                    ",", "\"\<+global time \>\"", ",", "globaltime", ",", 
                    "\"\< from population of size \>\"", ",", 
                    RowBox[{"bestclasssize", "/.", 
                    RowBox[{"t", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"mutationtime", ",", "timeuntilnextenvchange"}], 
                    "]"}]}]}], ",", " ", 
                    "\"\< giving rise to nose mutants at rate \>\"", ",", 
                    RowBox[{
                    RowBox[{"U", " ", "mostfitclass", " ", "bestclasssize"}], 
                    " ", "/.", 
                    RowBox[{"t", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"mutationtime", ",", "timeuntilnextenvchange"}], 
                    "]"}]}]}]}], "]"}], ";"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"mutationtime", "<", "timeuntilnextenvchange"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"q", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<(i-1) n\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}], "<>", 
                    "\"\<[t]\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}], "/", 
                    "totalpopsize"}], " ", "/.", 
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
                    RowBox[{"t", "\[Rule]", " ", "mutationtime"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "Relaxation", " ", "timescale", " ", "for", " ", "mutant",
                     " ", "fitness", " ", "advantage"}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{"s", "/", 
                    RowBox[{"(", 
                    RowBox[{"d", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"birth", "-", "deaths"}], ")"}], "/", "dt"}]}], 
                    ")"}]}], " ", "evaluated", " ", "at", " ", 
                    "mutationtime"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "if", " ", "comparable", " ", "or", " ", 
                    "smaller", " ", "than", " ", "decay", " ", "timescale", 
                    " ", "of", " ", "fixation", " ", 
                    RowBox[{
                    RowBox[{"prob", ".", " ", 
                    RowBox[{"integral", " ", "~", " ", "1"}]}], "/", 
                    RowBox[{"qs", "."}]}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"If", " ", "so"}], ",", " ", 
                    RowBox[{
                    "constant", " ", "popsize", " ", "at", " ", 
                    "mutationtime", " ", "not", " ", "reliable"}], ",", " ", 
                    RowBox[{
                    "use", " ", "averaged", " ", "fitness", " ", "advantage", 
                    " ", 
                    RowBox[{"instead", ".", " ", "Catches"}], " ", "mutants", 
                    " ", "that", " ", "arise", " ", "shortly", " ", "after", 
                    " ", "env", " ", "change"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"q", " ", 
                    RowBox[{"s", "/", "2"}]}], " ", "<", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    FractionBox["r0", "K"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r0", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{"totalpopsize", " "}], "K"]}], ")"}]}], "-", 
                    RowBox[{"(", 
                    RowBox[{"\[Mu]0", "+", 
                    RowBox[{"mostfitclass", " ", "s"}], "+", 
                    RowBox[{"q", " ", "s"}]}], ")"}]}], ")"}], 
                    "totalpopsize"}], "/.", 
                    RowBox[{"t", "\[Rule]", "mutationtime"}]}], ")"}], "/", 
                    "s"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pfix", "=", 
                    RowBox[{"CalcPfix2", "[", 
                    RowBox[{
                    "r0", ",", "\[Mu]0", ",", "s", ",", "K", ",", 
                    "mutationtime", ",", "timeuntilnextenvchange", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"totalpopsize", " ", "/.", 
                    RowBox[{"t", "\[Rule]", "#"}]}], ")"}], " ", "&"}], ",", 
                    RowBox[{"mostfitclass", "-", "1"}], ",", "q"}], "]"}]}], 
                    ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "if", " ", "constant", " ", "decay", " ", 
                    "has", " ", "reduced", " ", "the", " ", "integrand", " ", 
                    "by", " ", "less", " ", "than", " ", 
                    RowBox[{"1", "/", "3"}], " ", "at", " ", "the", " ", 
                    "time", " ", "of", " ", "environmental", " ", 
                    RowBox[{"change", ".", " ", "This"}], " ", "catches", " ",
                     "variants", " ", "that", " ", "arise", " ", "shortly", 
                    " ", "before", " ", "env", " ", "change"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", "/", "3"}], " ", "chosen", " ", "by", " ", 
                    "checking", " ", 
                    RowBox[{"errors", ".", " ", "Could"}], " ", "be", " ", 
                    "made", " ", "more", " ", "agressive", " ", 
                    RowBox[{
                    RowBox[{"e", ".", "g", ".", " ", "1"}], "/", "2"}], " ", 
                    "if", " ", "desired"}], " ", "-", " ", 
                    RowBox[{
                    "provides", " ", "little", " ", "gain", " ", "with", " ", 
                    "great", " ", "numerical", " ", "cost"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r0", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{"totalpopsize", " "}], "K"]}], ")"}]}], "-", 
                    RowBox[{"(", 
                    RowBox[{"\[Mu]0", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"mostfitclass", " ", "-", "1"}], ")"}], "s"}]}], 
                    ")"}]}], "/.", 
                    RowBox[{"t", "\[Rule]", "mutationtime"}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"timeuntilnextenvchange", "-", "mutationtime"}], 
                    ")"}]}], "<", 
                    RowBox[{"Log", "[", 
                    RowBox[{"3", "/", "2"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"solafter", "=", 
                    RowBox[{
                    RowBox[{"SolveDiffEqs", "[", 
                    RowBox[{
                    "r0", ",", "\[Mu]0", ",", "s", ",", "K", ",", "U", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                    RowBox[{"t", "\[Rule]", "timeuntilnextenvchange"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}], ",", 
                    "numgenotypes", ",", 
                    RowBox[{"mostfitclass", "+", "1"}], ",", 
                    "timebetweenenvchanges"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"totalpopsizeafter", "=", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<n\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}], "<>", 
                    "\"\<[t]\>\""}], "]"}], "/.", 
                    RowBox[{"solafter", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"pfix", "=", 
                    RowBox[{"CalcPfix3", "[", 
                    RowBox[{
                    "r0", ",", "\[Mu]0", ",", "s", ",", "K", ",", 
                    "mutationtime", ",", "timeuntilnextenvchange", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"totalpopsize", " ", "/.", 
                    RowBox[{"t", "\[Rule]", "#"}]}], ")"}], " ", "&"}], ",", 
                    RowBox[{"mostfitclass", "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"totalpopsizeafter", " ", "/.", 
                    RowBox[{"t", "\[Rule]", "#"}]}], ")"}], " ", "&"}], ",", 
                    "timebetweenenvchanges"}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pfix", "=", 
                    RowBox[{"CalcPfix", "[", 
                    RowBox[{
                    "r0", ",", "\[Mu]0", ",", "s", ",", "K", ",", 
                    "mutationtime", ",", 
                    RowBox[{"totalpopsize", " ", "/.", 
                    RowBox[{"t", "\[Rule]", "mutationtime"}]}], ",", 
                    RowBox[{"mostfitclass", "-", "1"}], ",", "q"}], "]"}]}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"fixationran", "=", 
                    RowBox[{"RandomReal", "[", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"fixation", "=", 
                    RowBox[{"(", 
                    RowBox[{"fixationran", "<", "pfix"}], ")"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", "veryverbose", ")"}], ",", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<establishment probability=\>\"", ",", "pfix", ",", 
                    "\"\< \>\"", ",", " ", "fixation"}], "]"}], ";"}]}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "any", " ", "new", " ", "environmental", " ", "change", 
                    " ", "is", " ", "going", " ", "to", " ", "make", " ", 
                    "this", " ", "worse", " ", "not", " ", "better"}], ",", 
                    " ", 
                    RowBox[{"density", " ", 
                    RowBox[{"won", "'"}], "t", " ", "drop", " ", "fast", " ", 
                    "enough", " ", "to", " ", "compensate", " ", "for", " ", 
                    "higher", " ", "nose", " ", "death", " ", 
                    RowBox[{"rate", ".", " ", "So"}], " ", "we", " ", "need", 
                    " ", "to", " ", "consider", " ", "mutations", " ", "that",
                     " ", 
                    RowBox[{"don", "'"}], "t", " ", "fix", " ", "after", " ", 
                    "all"}], ",", " ", 
                    RowBox[{
                    "but", " ", "not", " ", "ones", " ", "that", " ", "fail", 
                    " ", "to", " ", "fix", " ", "but", " ", "might", " ", 
                    "after", " ", "env", " ", 
                    RowBox[{"change", "."}]}]}], "*)"}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"fixation", " ", "&&", " ", 
                  RowBox[{"mutationtime", "<", "timeuntilnextenvchange"}]}], 
                 ")"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"establishtimeran", ",", "v0"}], "}"}], "=", 
                  RowBox[{"CalcEstablishmentTime", "[", "pfix", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"(", "veryverbose", ")"}], ",", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<establishes at freq=\>\"", ",", "v0", ",", " ", 
                    "\"\< at local time=\>\"", ",", "mutationtime", ",", 
                    "\"\<+global time \>\"", ",", "globaltime"}], "]"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"mostfitclass", ",", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "/.", 
                    RowBox[{"t", "\[Rule]", " ", "teval"}]}]}], "}"}], "]"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"teval", ",", 
                    RowBox[{
                    RowBox[{"Ceiling", "[", "globaltime", "]"}], "-", 
                    "globaltime"}], ",", "mutationtime"}], "}"}]}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"update", " ", "with", " ", "mutation"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"globaltime", "=", 
                  RowBox[{"globaltime", "+", "mutationtime"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"timeuntilnextenvchange", "=", 
                  RowBox[{"timeuntilnextenvchange", "-", "mutationtime"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"genotypeabundances", "=", 
                  RowBox[{"Prepend", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                    RowBox[{"t", "\[Rule]", "mutationtime"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}], ",", 
                    "v0"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"mostfitclass", "=", 
                  RowBox[{"mostfitclass", "-", "1"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"(", "veryverbose", ")"}], ",", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<add a genotype class, genotypeabundances = \>\"", 
                    ",", "genotypeabundances", ",", " ", "\"\< time=\>\"", 
                    ",", "mutationtime", ",", "\"\<=global time \>\"", ",", 
                    "globaltime", ",", " ", "\"\< mostfitclass=\>\"", ",", 
                    "mostfitclass"}], "]"}], ";"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"numgenotypes", "=", 
                  RowBox[{"numgenotypes", "+", "1"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"numgenotypes", ",", "genotypeabundances"}], "}"}],
                   "=", 
                  RowBox[{"PruneUnfitClasses", "[", 
                   RowBox[{"numgenotypes", ",", "genotypeabundances"}], 
                   "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"mostfitclass", ",", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "/.", 
                    RowBox[{"t", "\[Rule]", " ", "teval"}]}]}], "}"}], "]"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"teval", ",", 
                    RowBox[{
                    RowBox[{"Ceiling", "[", "globaltime", "]"}], "-", 
                    "globaltime"}], ",", "timeuntilnextenvchange"}], "}"}]}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"fixation", "=", "False"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"globaltime", "=", 
                  RowBox[{"globaltime", "+", "timeuntilnextenvchange"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"genotypeabundances", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                    RowBox[{"t", "\[Rule]", "timeuntilnextenvchange"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "record", " ", "last", " ", "environmental", " ", "change", 
                   " ", "interval", " ", "in", " ", "case", " ", "of", " ", 
                   "extinction"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"lastenvwaittime", "=", "timeuntilnextenvchange"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"timeuntilnextenvchange", "=", 
                  RowBox[{"RandomReal", "[", 
                   RowBox[{"ExponentialDistribution", "[", 
                    RowBox[{"1", "/", "timebetweenenvchanges"}], "]"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"mostfitclass", "=", 
                  RowBox[{"mostfitclass", "+", "1"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"(", "veryverbose", ")"}], ",", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Environmental change at time \>\"", ",", " ", 
                    "timeuntilnextenvchange", ",", 
                    "\"\< before mutant at time \>\"", ",", "mutationtime", 
                    ",", "\"\<+\>\"", ",", "globaltime", ",", "\"\<=\>\"", 
                    ",", 
                    RowBox[{"mutationtime", "+", "globaltime"}], ",", " ", 
                    "\"\< new mostfitclass=\>\"", ",", "mostfitclass", ",", 
                    " ", "\"\< abundances=\>\"", ",", "genotypeabundances"}], 
                    "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"numgenotypes", ",", "genotypeabundances"}], "}"}],
                   "=", 
                  RowBox[{"PruneUnfitClasses", "[", 
                   RowBox[{"numgenotypes", ",", "genotypeabundances"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"numgenotypes", "==", "0"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"extinct", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "Solve", " ", "for", " ", "extinction", " ", "time", " ", 
                    
                    RowBox[{"i", ".", "e", ".", " ", "when"}], " ", "N"}], "==", 
                    RowBox[{"1.", " ", "numgenotypes"}], "\[Equal]", 
                    RowBox[{"0", " ", 
                    RowBox[{"doesn", "'"}], "t", " ", "guarantee", " ", "N"}],
                     "==", 
                    RowBox[{
                    "1", " ", "in", " ", "the", " ", "previous", " ", 
                    "interval"}]}], ",", " ", 
                    RowBox[{"but", " ", "if", " ", "this", " ", "occurs", " ", 
                    RowBox[{"(", "rarely", ")"}], " ", "it", " ", "will", " ",
                     "be", " ", "so", " ", "close", " ", "that", " ", "we", 
                    " ", "can", " ", "just", " ", "choose", " ", "the", " ", 
                    "end", " ", "of", " ", "the", " ", "interval", " ", "as", 
                    " ", "the", " ", "extinction", " ", "time"}]}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "/.", 
                    RowBox[{"t", "\[Rule]", " ", "lastenvwaittime"}]}], ")"}],
                     "<", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"timeuntilnextenvchange", "=", 
                    RowBox[{"t", "/.", 
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    "\[Equal]", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "0", ",", "lastenvwaittime"}], "}"}], 
                    ",", 
                    RowBox[{"Method", "->", "\"\<Brent\>\""}]}], "]"}]}]}], 
                    ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    
                    RowBox[{
                    RowBox[{
                    "timeuntilnextenvchange", "=", "lastenvwaittime"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<going extinct at time \>\"", ",", 
                    RowBox[{
                    "globaltime", "-", "lastenvwaittime", "+", 
                    "timeuntilnextenvchange"}], ",", "\"\< before time \>\"", 
                    ",", "globaltime", ",", "\"\< and \>\"", ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"globaltime", "/", "timebetweenenvchanges"}], 
                    "]"}], ",", "\"\< changes at rate \>\"", ",", 
                    "timebetweenenvchanges"}], "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"globaltime", "=", 
               RowBox[{"globaltime", "+", "timeuntilnextenvchange"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"genotypeabundances", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "/.", 
                  RowBox[{"t", "\[Rule]", "timeuntilnextenvchange"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"timeuntilnextenvchange", "=", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"ExponentialDistribution", "[", 
                 RowBox[{"1", "/", "timebetweenenvchanges"}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"mostfitclass", "=", 
               RowBox[{"mostfitclass", "+", "1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"(", "verbose", ")"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<mostfitclass is perfectly adapted, skip to \
environmental change globaltime=\>\"", ",", "globaltime", ",", 
                   "\"\< genotypeabundances=\>\"", ",", 
                   "genotypeabundances"}], "]"}], ";"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"numgenotypes", ",", "genotypeabundances"}], "}"}], 
               "=", 
               RowBox[{"PruneUnfitClasses", "[", 
                RowBox[{"numgenotypes", ",", "genotypeabundances"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"history", "=", 
      RowBox[{
       RowBox[{"history", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"(", "extinct", ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "globaltime", "-", "lastenvwaittime", "+", 
          "timeuntilnextenvchange"}], ",", "history"}], "}"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<not extinct before \>\"", ",", "maxtime", ",", 
          "\"\< with changes at rate \>\"", ",", "timebetweenenvchanges"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"maxtime", ",", "history"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5244973360024247`*^9, 3.524497370428464*^9}, {
   3.524497402589632*^9, 3.52449749651149*^9}, {3.5244975385443716`*^9, 
   3.524497573642062*^9}, {3.5244976050690994`*^9, 3.5244976204702225`*^9}, {
   3.524497678747696*^9, 3.524497686885612*^9}, {3.5244977428513556`*^9, 
   3.524497759127187*^9}, {3.52449789475391*^9, 3.5244979306794505`*^9}, {
   3.5244979790695906`*^9, 3.524497990112789*^9}, {3.524498031551546*^9, 
   3.524498097730256*^9}, {3.524498133897508*^9, 3.5244981696105165`*^9}, {
   3.524498290862444*^9, 3.5244982996810503`*^9}, {3.524498361219496*^9, 
   3.52449839468182*^9}, {3.5244985062958703`*^9, 3.524498570202655*^9}, {
   3.5244986168547807`*^9, 3.52449864785855*^9}, {3.524498711350645*^9, 
   3.5244987806559467`*^9}, {3.524498894091614*^9, 3.5244988944197783`*^9}, {
   3.524498927637458*^9, 3.524498958181205*^9}, 3.5244990099571524`*^9, {
   3.5244990537807894`*^9, 3.5244990825903387`*^9}, {3.5244991317103086`*^9, 
   3.524499167316037*^9}, {3.5244992063587837`*^9, 3.5244992473511744`*^9}, {
   3.5244992885935183`*^9, 3.5244993242431507`*^9}, {3.5244993812950597`*^9, 
   3.5244993965266075`*^9}, {3.5244994611708565`*^9, 3.524499521815412*^9}, {
   3.524499583833561*^9, 3.5244995861924376`*^9}, {3.5245015148787503`*^9, 
   3.524501544387575*^9}, {3.524502013817621*^9, 3.5245020330302095`*^9}, 
   3.5245021623126388`*^9, {3.524502418270337*^9, 3.5245025138693795`*^9}, 
   3.5245027696293488`*^9, {3.524502946091789*^9, 3.5245029469510484`*^9}, 
   3.524503042172624*^9, {3.524503185464307*^9, 3.524503186401663*^9}, {
   3.5245032247863913`*^9, 3.5245032253331823`*^9}, {3.524503266967411*^9, 
   3.5245032706543446`*^9}, {3.5245035245052032`*^9, 
   3.5245035254737988`*^9}, {3.5245106986557946`*^9, 3.524510698905753*^9}, {
   3.5245161195783587`*^9, 3.5245162263636203`*^9}, {3.52457295575*^9, 
   3.524572957578125*^9}, {3.524573178578125*^9, 3.524573178734375*^9}, {
   3.524573318578125*^9, 3.5245733253125*^9}, {3.524579642796875*^9, 
   3.5245796725625*^9}, {3.524579718796875*^9, 3.524579726453125*^9}, 
   3.5245797883125*^9, {3.52458005228125*^9, 3.524580077765625*^9}, {
   3.5245802688125*^9, 3.524580289390625*^9}, {3.524580473390625*^9, 
   3.524580507734375*^9}, {3.52458156940625*^9, 3.524581580609375*^9}, {
   3.524581659078125*^9, 3.524581678421875*^9}, {3.524581766421875*^9, 
   3.524581820515625*^9}, {3.52458215559375*^9, 3.524582158515625*^9}, {
   3.5245822696875*^9, 3.524582283515625*^9}, {3.52458236753125*^9, 
   3.52458243515625*^9}, {3.524582484078125*^9, 3.52458266828125*^9}, {
   3.52458272615625*^9, 3.524582856*^9}, {3.524583008671875*^9, 
   3.524583054078125*^9}, {3.52458319596875*^9, 3.5245832349375*^9}, {
   3.524583364765625*^9, 3.524583456328125*^9}, {3.524583490625*^9, 
   3.524583508296875*^9}, {3.52458421053125*^9, 3.524584225734375*^9}, {
   3.5245842635*^9, 3.524584270203125*^9}, {3.524584632015625*^9, 
   3.524584636109375*^9}, {3.52458478175*^9, 3.524584783921875*^9}, {
   3.524584858609375*^9, 3.524584888921875*^9}, {3.52459105196875*^9, 
   3.524591058046875*^9}, {3.5245911364375*^9, 3.524591209609375*^9}, 
   3.524591253328125*^9, {3.5245912836875*^9, 3.52459138490625*^9}, {
   3.524591426265625*^9, 3.524591442546875*^9}, 3.52459160390625*^9, {
   3.5245952190110774`*^9, 3.5245952311204524`*^9}, 3.5245953399017024`*^9, {
   3.5245957010110774`*^9, 3.5245957302923274`*^9}, {3.5245973839798274`*^9, 
   3.5245974394329524`*^9}, {3.5245990324954524`*^9, 
   3.5245990329954524`*^9}, {3.5245991987142024`*^9, 
   3.5245992482298274`*^9}, {3.5246091030892024`*^9, 
   3.5246091175423274`*^9}, {3.5246091755267024`*^9, 
   3.5246091827142024`*^9}, {3.5246096671517024`*^9, 3.5246097177454524`*^9}, 
   3.5246097893704524`*^9, {3.5246098946517024`*^9, 3.5246099640110774`*^9}, {
   3.5246099988235774`*^9, 3.5246099999642024`*^9}, {3.5246101062142024`*^9, 
   3.5246101084642024`*^9}, {3.5246101564329524`*^9, 
   3.5246102844329524`*^9}, {3.525206196715081*^9, 3.525206196871331*^9}, {
   3.52527328796875*^9, 3.525273298234375*^9}, {3.530991813857375*^9, 
   3.5309919187243204`*^9}, {3.5309919723295784`*^9, 3.5309920116859303`*^9}, 
   3.5309920422929544`*^9, {3.531245273546875*^9, 3.53124527559375*^9}, {
   3.53124549215625*^9, 3.53124549621875*^9}, {3.53124559*^9, 
   3.53124559146875*^9}, {3.531248435578125*^9, 3.531248458265625*^9}, 
   3.531248681734375*^9, {3.531248951328125*^9, 3.531248961984375*^9}, 
   3.531249372703125*^9, {3.531249444765625*^9, 3.531249446609375*^9}, {
   3.531249639015625*^9, 3.53124964040625*^9}, 3.531250586375*^9, {
   3.5312569675*^9, 3.531256976984375*^9}, {3.531258336*^9, 
   3.531258370296875*^9}, {3.531258426484375*^9, 3.531258463953125*^9}, {
   3.53125850415625*^9, 3.53125854975*^9}, {3.53125858784375*^9, 
   3.531258671984375*^9}, {3.53125870384375*^9, 3.53125879503125*^9}, {
   3.531258840515625*^9, 3.531258916515625*^9}, {3.5317732021875*^9, 
   3.53177328665625*^9}, {3.53177331875*^9, 3.531773345359375*^9}, {
   3.531773507046875*^9, 3.53177352803125*^9}, {3.531773816234375*^9, 
   3.531773842046875*^9}, {3.53177388628125*^9, 3.53177391296875*^9}, {
   3.53177394625*^9, 3.5317741275625*^9}, {3.53177419559375*^9, 
   3.531774293625*^9}, {3.532459148875*^9, 3.532459182921875*^9}, {
   3.53245921946875*^9, 3.532459365015625*^9}, {3.532459398078125*^9, 
   3.53245941928125*^9}, {3.5324595393125*^9, 3.53245957028125*^9}, {
   3.5324596155625*^9, 3.5324597445*^9}, {3.5324597986875*^9, 
   3.532459799015625*^9}, {3.532459882484375*^9, 3.53245996834375*^9}, {
   3.5324600238125*^9, 3.53246004209375*^9}, {3.53246020390625*^9, 
   3.53246021215625*^9}, 3.53246093496875*^9, {3.53246097621875*^9, 
   3.532461123265625*^9}, {3.5324612195625*^9, 3.532461220265625*^9}, {
   3.532462867765625*^9, 3.532463003515625*^9}, {3.532463055015625*^9, 
   3.53246313675*^9}, {3.53246406709375*^9, 3.532464101140625*^9}, {
   3.532464158484375*^9, 3.532464161953125*^9}, {3.53246420109375*^9, 
   3.532464206109375*^9}, {3.532464255484375*^9, 3.53246428475*^9}, 
   3.53246433303125*^9, {3.532464440515625*^9, 3.532464448015625*^9}, {
   3.53246450103125*^9, 3.532464544078125*^9}, {3.53271178840625*^9, 
   3.532711909359375*^9}, {3.532711985640625*^9, 3.532711996546875*^9}, {
   3.53271202959375*^9, 3.532712068140625*^9}, {3.532712104375*^9, 
   3.53271210540625*^9}, {3.53271217921875*^9, 3.532712236578125*^9}, {
   3.532712299296875*^9, 3.5327123041875*^9}, {3.53271235003125*^9, 
   3.53271238640625*^9}, {3.53271242328125*^9, 3.532712434828125*^9}, {
   3.532712551546875*^9, 3.53271256065625*^9}, {3.53271266478125*^9, 
   3.532712674046875*^9}, {3.532712742140625*^9, 3.532712745125*^9}, {
   3.532712831*^9, 3.53271284603125*^9}, {3.532712895171875*^9, 
   3.532712917359375*^9}, {3.53271296290625*^9, 3.5327129725*^9}, {
   3.532714056875*^9, 3.5327141680625*^9}, {3.532714215734375*^9, 
   3.53271425940625*^9}, 3.53271511240625*^9, {3.532782156671875*^9, 
   3.532782159671875*^9}, {3.532782218234375*^9, 3.53278222753125*^9}, {
   3.532782903578125*^9, 3.53278291640625*^9}, {3.532782955484375*^9, 
   3.532783120578125*^9}, {3.532783154453125*^9, 3.532783191421875*^9}, {
   3.5327833185*^9, 3.5327833570625*^9}, 3.532783429453125*^9, {
   3.532783513984375*^9, 3.5327835305*^9}, {3.5327835956875*^9, 
   3.532783600921875*^9}, {3.53278363234375*^9, 3.532783633953125*^9}, {
   3.532783676234375*^9, 3.532783724921875*^9}, {3.53278716121875*^9, 
   3.532787211890625*^9}, {3.5327872708125*^9, 3.532787312046875*^9}, {
   3.532787534625*^9, 3.532787559640625*^9}, {3.53279848384375*^9, 
   3.53279848440625*^9}, {3.53280004009375*^9, 3.532800096890625*^9}, {
   3.532800187375*^9, 3.53280022603125*^9}, {3.53280207796875*^9, 
   3.532802095421875*^9}, {3.532803863984375*^9, 3.532803870046875*^9}, 
   3.532804668859375*^9, {3.53280496240625*^9, 3.53280497728125*^9}, {
   3.53280502115625*^9, 3.53280509528125*^9}, {3.532805141078125*^9, 
   3.53280519596875*^9}, {3.532805239015625*^9, 3.532805255359375*^9}, {
   3.532805966765625*^9, 3.532806094109375*^9}, {3.53280612734375*^9, 
   3.53280615559375*^9}, 3.532806515625*^9, {3.532807061390625*^9, 
   3.532807077875*^9}, {3.532807403453125*^9, 3.532807432953125*^9}, {
   3.532807509921875*^9, 3.532807512546875*^9}, {3.532809882609375*^9, 
   3.532809937734375*^9}, 3.532876935859375*^9, {3.532877222125*^9, 
   3.532877232875*^9}, {3.53288090659375*^9, 3.532880912109375*^9}, {
   3.5328822880625*^9, 3.53288230328125*^9}, {3.532882599421875*^9, 
   3.532882612203125*^9}, {3.532882662078125*^9, 3.532882669375*^9}, {
   3.532882807390625*^9, 3.532882814921875*^9}, {3.53288330434375*^9, 
   3.532883309671875*^9}, {3.53288439084375*^9, 3.532884403296875*^9}, {
   3.53288446640625*^9, 3.5328844690625*^9}, {3.5328847723125*^9, 
   3.532884793046875*^9}, {3.532885054703125*^9, 3.532885068171875*^9}, {
   3.532887787453125*^9, 3.532887800265625*^9}, {3.532887854359375*^9, 
   3.532887948046875*^9}, {3.532887980078125*^9, 3.5328879985625*^9}, {
   3.532888029640625*^9, 3.532888037875*^9}, {3.532888521234375*^9, 
   3.532888544421875*^9}, {3.5328889185*^9, 3.532888977578125*^9}, {
   3.532889033125*^9, 3.5328890470625*^9}, {3.532889137359375*^9, 
   3.532889146890625*^9}, {3.532889412140625*^9, 3.532889454140625*^9}, {
   3.532889529671875*^9, 3.53288955571875*^9}, {3.532889684859375*^9, 
   3.53288974446875*^9}, {3.532889774609375*^9, 3.532889830171875*^9}, 
   3.532889903*^9, {3.532889974859375*^9, 3.5328900226875*^9}, {
   3.532890113453125*^9, 3.532890118515625*^9}, {3.53289021371875*^9, 
   3.532890213953125*^9}, {3.532890247796875*^9, 3.53289045225*^9}, {
   3.5328905071875*^9, 3.53289051075*^9}, {3.532890650921875*^9, 
   3.532890653828125*^9}, {3.5328907003125*^9, 3.532890735640625*^9}, {
   3.532890779390625*^9, 3.53289082946875*^9}, {3.532890921296875*^9, 
   3.5328909349375*^9}, {3.53289100303125*^9, 3.532891040375*^9}, 
   3.532891075796875*^9, {3.53289114940625*^9, 3.532891185640625*^9}, {
   3.5328912184375*^9, 3.53289121871875*^9}, {3.532891567125*^9, 
   3.53289156815625*^9}, {3.5328916065*^9, 3.5328916271875*^9}, {
   3.532891847515625*^9, 3.5328918683125*^9}, {3.5328919345*^9, 
   3.5328919486875*^9}, {3.532892308171875*^9, 3.532892314140625*^9}, {
   3.532892448453125*^9, 3.532892450125*^9}, {3.532892554203125*^9, 
   3.532892590703125*^9}, {3.5328933286875*^9, 3.53289332896875*^9}, {
   3.532893501515625*^9, 3.53289351709375*^9}, {3.53289356509375*^9, 
   3.532893565671875*^9}, {3.53289365203125*^9, 3.53289365725*^9}, {
   3.532893722234375*^9, 3.53289373878125*^9}, {3.532893795203125*^9, 
   3.532893807796875*^9}, {3.5328938558125*^9, 3.532893888609375*^9}, {
   3.53289410571875*^9, 3.53289410934375*^9}, {3.53289423646875*^9, 
   3.532894252078125*^9}, {3.53289430984375*^9, 3.532894332140625*^9}, {
   3.5328943649375*^9, 3.53289436971875*^9}, {3.53289461134375*^9, 
   3.532894615390625*^9}, 3.53289553809375*^9, {3.53289557528125*^9, 
   3.53289562234375*^9}, {3.532897109953125*^9, 3.532897184046875*^9}, {
   3.53289865009375*^9, 3.532898658859375*^9}, {3.532898695296875*^9, 
   3.532898709328125*^9}, {3.53289889703125*^9, 3.53289891340625*^9}, {
   3.532899170140625*^9, 3.532899220375*^9}, {3.533654520125*^9, 
   3.5336545354375*^9}, {3.5336545861875*^9, 3.533654673953125*^9}, {
   3.533654764859375*^9, 3.533654840890625*^9}, {3.5336549380625*^9, 
   3.5336549553125*^9}, {3.533654987625*^9, 3.53365498878125*^9}, {
   3.533656656984375*^9, 3.53365666759375*^9}, {3.533656702421875*^9, 
   3.5336567721875*^9}, {3.53365984634375*^9, 3.53365998165625*^9}, {
   3.533660200390625*^9, 3.533660233875*^9}, {3.533660273875*^9, 
   3.53366029490625*^9}, {3.5336603633125*^9, 3.53366036371875*^9}, {
   3.533660415515625*^9, 3.5336604179375*^9}, {3.533660464046875*^9, 
   3.533660547859375*^9}, {3.53366065653125*^9, 3.533660747890625*^9}, {
   3.533660787453125*^9, 3.53366082390625*^9}, {3.533660914390625*^9, 
   3.53366091890625*^9}, {3.533660959734375*^9, 3.533660968015625*^9}, {
   3.533661114140625*^9, 3.533661119203125*^9}, {3.5336611623125*^9, 
   3.533661198671875*^9}, {3.533661248625*^9, 3.533661252046875*^9}, {
   3.533661346515625*^9, 3.533661437734375*^9}, {3.533661496109375*^9, 
   3.53366151009375*^9}, {3.533661920203125*^9, 3.533661930625*^9}, {
   3.53366196634375*^9, 3.53366197921875*^9}, {3.533662342375*^9, 
   3.53366235990625*^9}, {3.533664437640625*^9, 3.533664490828125*^9}, {
   3.533664525125*^9, 3.53366454459375*^9}, {3.53366470621875*^9, 
   3.533664717171875*^9}, 3.53366478578125*^9, {3.533665549203125*^9, 
   3.533665555*^9}, {3.533665643625*^9, 3.53366566978125*^9}, {
   3.533665706734375*^9, 3.533665743734375*^9}, {3.53366579625*^9, 
   3.533665813640625*^9}, 3.53366593559375*^9, {3.53366598365625*^9, 
   3.533666008984375*^9}, {3.533666442125*^9, 3.5336664715625*^9}, {
   3.5401240069375*^9, 3.540124007109375*^9}, {3.540124913875*^9, 
   3.540124977296875*^9}, {3.540128939515625*^9, 3.54012897728125*^9}, {
   3.540129010765625*^9, 3.540129134859375*^9}, {3.540219605359375*^9, 
   3.54021960659375*^9}, {3.54049050021875*^9, 3.54049050071875*^9}, 
   3.540558852171875*^9, 3.54056062471875*^9, {3.540560817578125*^9, 
   3.54056086865625*^9}, {3.54056098996875*^9, 3.540561007609375*^9}, {
   3.5405612995625*^9, 3.540561353*^9}, 3.540561463328125*^9, {
   3.54056151321875*^9, 3.54056152215625*^9}, {3.540738563640625*^9, 
   3.540738564125*^9}, {3.540738614578125*^9, 3.5407386520625*^9}, {
   3.540739286921875*^9, 3.54073928728125*^9}, {3.540739350875*^9, 
   3.54073935190625*^9}, {3.5407393918125*^9, 3.540739392109375*^9}, {
   3.540739599734375*^9, 3.540739636546875*^9}, {3.540739823609375*^9, 
   3.54074015478125*^9}, {3.54074018759375*^9, 3.54074020815625*^9}, {
   3.540740256390625*^9, 3.540740303328125*^9}, 3.540740372421875*^9, 
   3.540740407578125*^9, 3.54074045428125*^9, {3.540740726578125*^9, 
   3.5407407273125*^9}, {3.540740767890625*^9, 3.540740780046875*^9}, 
   3.540818929734375*^9, {3.546110535828125*^9, 3.546110546203125*^9}, {
   3.5461105915625*^9, 3.546110657984375*^9}, {3.5461107185*^9, 
   3.546110742546875*^9}, {3.546110784390625*^9, 3.546110845515625*^9}, {
   3.546110911046875*^9, 3.5461109116875*^9}, {3.54611156515625*^9, 
   3.546111573609375*^9}, {3.546112250671875*^9, 3.5461122660625*^9}, {
   3.54635987253125*^9, 3.54635996509375*^9}, 3.546359999640625*^9, 
   3.546360033484375*^9, {3.546360165171875*^9, 3.546360168234375*^9}, {
   3.54636223159375*^9, 3.546362251890625*^9}, {3.54636229184375*^9, 
   3.54636229396875*^9}, {3.546362398953125*^9, 3.54636240596875*^9}, {
   3.546362466390625*^9, 3.54636247828125*^9}, {3.5463625103125*^9, 
   3.5463625293125*^9}, {3.54661287471875*^9, 3.54661288621875*^9}, {
   3.546613050703125*^9, 3.546613065875*^9}, 3.546613114171875*^9, {
   3.5466134263125*^9, 3.546613454390625*^9}, {3.546613589328125*^9, 
   3.5466136684375*^9}, {3.546613764671875*^9, 3.546613781859375*^9}, {
   3.54661388715625*^9, 3.546613889078125*^9}, {3.546613920171875*^9, 
   3.54661404909375*^9}, {3.54661512815625*^9, 3.546615216234375*^9}, {
   3.5466155048125*^9, 3.546615505484375*^9}, {3.546615542296875*^9, 
   3.546615548078125*^9}, {3.546615726*^9, 3.5466157529375*^9}, {
   3.546620643859375*^9, 3.5466206571875*^9}, {3.546620712609375*^9, 
   3.5466207298125*^9}, {3.5466298175*^9, 3.546629817875*^9}, {
   3.553685949330875*^9, 3.5536860063465*^9}, {3.5536861410965*^9, 
   3.553686158018375*^9}, {3.553686196143375*^9, 3.553686197862125*^9}, {
   3.5536867798465*^9, 3.553686856955875*^9}, {3.55368688862775*^9, 
   3.553686900049625*^9}, {3.553688118268375*^9, 3.553688123034*^9}, {
   3.553688162830875*^9, 3.553688163643375*^9}, {3.553688346784*^9, 
   3.553688346893375*^9}, {3.5536888447215*^9, 3.55368884550275*^9}, {
   3.553689105487125*^9, 3.55368920212775*^9}, {3.553689397784*^9, 
   3.553689469862125*^9}, {3.55368969069025*^9, 3.553689696909*^9}, {
   3.553689835112125*^9, 3.5536898380965*^9}, {3.55369022375275*^9, 
   3.553690253159*^9}, {3.553746505890625*^9, 3.553746506953125*^9}, {
   3.553769422328125*^9, 3.553769460453125*^9}, {3.553769584796875*^9, 
   3.5537696259375*^9}, {3.553769696671875*^9, 3.553769799015625*^9}, {
   3.553769935265625*^9, 3.5537699363125*^9}, {3.553769985546875*^9, 
   3.5537699993125*^9}, 3.553770320796875*^9, {3.553770419046875*^9, 
   3.553770419921875*^9}, {3.55377303578125*^9, 3.553773036625*^9}, {
   3.557741397015625*^9, 3.557741446171875*^9}, {3.55774231390625*^9, 
   3.557742372140625*^9}, {3.557742409359375*^9, 3.5577424096875*^9}, 
   3.6343080989742002`*^9, 3.634308168244162*^9, {3.6343214463744287`*^9, 
   3.634321448381544*^9}, {3.634321629858924*^9, 3.634321630236945*^9}, {
   3.6343217247783527`*^9, 3.634321734916933*^9}, {3.634321861726186*^9, 
   3.6343218619371977`*^9}, {3.63432211321157*^9, 3.6343221183158617`*^9}, {
   3.6343228801604366`*^9, 3.634322880306445*^9}, {3.6343235594402895`*^9, 
   3.6343235617194195`*^9}, {3.6344075450053463`*^9, 3.634407572750933*^9}, {
   3.634408239427065*^9, 3.6344082752801156`*^9}, 3.6344083319983597`*^9, {
   3.634855593311482*^9, 3.634855610988493*^9}, {3.6348556843226876`*^9, 
   3.6348557011026473`*^9}, {3.634855763195199*^9, 3.6348558187483764`*^9}, 
   3.635010495144869*^9, {3.635075546117605*^9, 3.6350755524709682`*^9}, {
   3.63507578851647*^9, 3.635075788920493*^9}, {3.6351791287464285`*^9, 
   3.635179137542932*^9}, {3.635182440156831*^9, 3.6351824403528423`*^9}, {
   3.635184702744243*^9, 3.635184703174268*^9}, {3.6351848747630825`*^9, 
   3.6351849218647766`*^9}, {3.6351852442602167`*^9, 
   3.6351852446652393`*^9}, {3.6351855102254286`*^9, 3.635185533177741*^9}, {
   3.6351861054874754`*^9, 3.6351861059625025`*^9}, {3.6351864609968095`*^9, 
   3.6351865031662216`*^9}, {3.635186580897668*^9, 3.6351865812696886`*^9}, {
   3.6351878951648393`*^9, 3.6351878954658566`*^9}, {3.63546191933792*^9, 
   3.635461961213315*^9}, {3.635465842412307*^9, 3.635465851227811*^9}, {
   3.635466529867627*^9, 3.6354665342768793`*^9}, {3.6421658849278526`*^9, 
   3.6421658877000113`*^9}, {3.6421671341583047`*^9, 
   3.6421671373864894`*^9}, {3.6421676738841753`*^9, 3.642167675661277*^9}, {
   3.6421677514916143`*^9, 3.642167753320719*^9}, {3.642168574415683*^9, 
   3.6421685747177*^9}, {3.64216877385509*^9, 3.6421688396068506`*^9}, {
   3.6421688899607306`*^9, 3.642168895992076*^9}, {3.6421693584215255`*^9, 
   3.642169386209115*^9}, {3.6421695410849733`*^9, 3.6421695454822245`*^9}, {
   3.6421696740395775`*^9, 3.6421696775527782`*^9}, 3.6421697990527277`*^9, {
   3.642171839436431*^9, 3.642171839802452*^9}, {3.642171894919605*^9, 
   3.6421719775543313`*^9}, {3.64217203960888*^9, 3.6421720623521814`*^9}, {
   3.6421721619968805`*^9, 3.6421721622038927`*^9}, {3.6421723158106785`*^9, 
   3.6421723162027006`*^9}, {3.642172397804368*^9, 3.642172399532467*^9}, {
   3.643396169463654*^9, 3.6433961760760326`*^9}, {3.643463454464038*^9, 
   3.643463525179083*^9}, {3.6434635914458733`*^9, 3.643463627665945*^9}, {
   3.64346397009453*^9, 3.643463991186737*^9}, {3.6434642729968557`*^9, 
   3.643464346493059*^9}, {3.643464387642413*^9, 3.6434643940747805`*^9}, {
   3.643464430289852*^9, 3.6434644392443647`*^9}, {3.643465213020622*^9, 
   3.643465213229634*^9}, {3.643465322853904*^9, 3.6434653295272856`*^9}, {
   3.6434653833523645`*^9, 3.6434654204384856`*^9}, {3.6434655070784407`*^9, 
   3.6434655184170895`*^9}, {3.6434656277003403`*^9, 3.643465739958761*^9}, {
   3.643465771169546*^9, 3.643465777167889*^9}, {3.643465810611802*^9, 
   3.643465827618775*^9}, {3.6434658839869986`*^9, 3.643466148586133*^9}, {
   3.6434661808159766`*^9, 3.6434661953258066`*^9}, {3.643587637999755*^9, 
   3.6435876400678735`*^9}, {3.643587999454429*^9, 3.643588022035721*^9}, {
   3.6435883092281475`*^9, 3.6435883093091516`*^9}, {3.658326698202959*^9, 
   3.6583266993378143`*^9}, {3.6583269647484703`*^9, 3.65832697384737*^9}, 
   3.658327875076147*^9, {3.658333263133259*^9, 3.658333313211404*^9}, {
   3.6584983057868757`*^9, 3.658498334371937*^9}, {3.658498374213229*^9, 
   3.6584983942394247`*^9}, {3.659294032129047*^9, 3.6592940328956537`*^9}, {
   3.6592972720738564`*^9, 3.6592972767637653`*^9}, 3.659357519606907*^9, 
   3.659375148073146*^9, {3.659375275601243*^9, 3.659375293537122*^9}, {
   3.659375332258545*^9, 3.659375335129759*^9}, {3.65937551837428*^9, 
   3.659375524017941*^9}, {3.6593765272545977`*^9, 3.659376536370241*^9}, {
   3.659376711916394*^9, 3.65937672305447*^9}, {3.659377666522231*^9, 
   3.659377816341423*^9}, {3.6593779845858583`*^9, 3.6593779966257677`*^9}, {
   3.659378291764921*^9, 3.659378298373665*^9}, {3.659381215104175*^9, 
   3.6593812187669697`*^9}, {3.659385853928739*^9, 3.659385859695641*^9}, {
   3.6593894980092707`*^9, 3.659389594368537*^9}, {3.6593900178403053`*^9, 
   3.659390018183797*^9}, {3.659390168378117*^9, 3.659390202745818*^9}, {
   3.659390730425633*^9, 3.659390732472837*^9}, {3.6593908528109426`*^9, 
   3.6593908585701714`*^9}, {3.659390919411833*^9, 3.65939095174771*^9}, {
   3.659390986661154*^9, 3.659391025709928*^9}, {3.659391058062634*^9, 
   3.659391076637019*^9}, {3.6593911488318367`*^9, 3.65939116487171*^9}, 
   3.659391229896543*^9, {3.659391307183489*^9, 3.659391313133683*^9}, {
   3.659391358708701*^9, 3.659391375611627*^9}, {3.6593920310587387`*^9, 
   3.6593920506652737`*^9}, {3.6610442604391537`*^9, 
   3.6610443115760784`*^9}, {3.66104434849619*^9, 3.6610444060954847`*^9}, {
   3.661044456214351*^9, 3.661044462568715*^9}, {3.6610448385762215`*^9, 
   3.6610448459266415`*^9}, {3.6610448836237974`*^9, 3.661044884152828*^9}, {
   3.6610449185987983`*^9, 3.6610449198128676`*^9}, {3.6610450921347237`*^9, 
   3.661045099548148*^9}, 3.661045263079501*^9, {3.661045432419187*^9, 
   3.6610454401046267`*^9}, {3.6610474428921795`*^9, 3.661047445930353*^9}, {
   3.661050882382907*^9, 3.6610508989288535`*^9}, {3.661050960351367*^9, 
   3.6610509761002674`*^9}, {3.661052802747245*^9, 3.6610528349190845`*^9}, {
   3.661052926903346*^9, 3.6610529484095764`*^9}, {3.663946879763688*^9, 
   3.66394689698458*^9}, {3.663946947245682*^9, 3.6639469502861757`*^9}, 
   3.664136713916868*^9, {3.664136749950441*^9, 3.664136795897861*^9}, {
   3.66413753961801*^9, 3.664137632330819*^9}, {3.66413883525566*^9, 
   3.664138867208143*^9}, {3.664138918302499*^9, 3.664138925595199*^9}, {
   3.6641389591685753`*^9, 3.66413898260861*^9}, {3.664139018305213*^9, 
   3.6641390277425003`*^9}, {3.664139113701828*^9, 3.6641391142342854`*^9}, {
   3.664139267417286*^9, 3.664139289898074*^9}, {3.66413949029795*^9, 
   3.6641395641379423`*^9}, {3.664139713422122*^9, 3.664139779838517*^9}, {
   3.664139838744205*^9, 3.664139856158431*^9}, {3.664139942010437*^9, 
   3.664139952516706*^9}, {3.66414067014458*^9, 3.6641406815833817`*^9}, {
   3.664140832188923*^9, 3.664140879486443*^9}, {3.6641410742283573`*^9, 
   3.664141076423029*^9}, {3.664141122616757*^9, 3.664141124484701*^9}, {
   3.664141297207205*^9, 3.6641413139219313`*^9}, {3.6642846870920258`*^9, 
   3.66428468723285*^9}, {3.664562967744102*^9, 3.664562989342041*^9}, {
   3.6645862500178547`*^9, 3.664586258166561*^9}, {3.674229346076086*^9, 
   3.6742293835935783`*^9}, {3.674234628505447*^9, 3.674234692050294*^9}, {
   3.6742349241019983`*^9, 3.6742349251114607`*^9}, {3.6742350000570107`*^9, 
   3.674235007534616*^9}, {3.6742350616486177`*^9, 3.674235137409719*^9}, {
   3.674235190514681*^9, 3.6742352616607313`*^9}, {3.674235296614574*^9, 
   3.674235299326109*^9}, {3.674235369229198*^9, 3.674235375913333*^9}, {
   3.674235431383211*^9, 3.674235461469705*^9}, {3.674236168890441*^9, 
   3.674236238441059*^9}, {3.674236561309421*^9, 3.674236565213729*^9}, {
   3.6742366497271223`*^9, 3.674236653082429*^9}, {3.674238465317116*^9, 
   3.6742385118389263`*^9}, {3.674238547781246*^9, 3.674238572151846*^9}, {
   3.674238808723486*^9, 3.674238959944213*^9}, {3.67423930324011*^9, 
   3.6742393394986753`*^9}, {3.674239509173051*^9, 3.674239553673167*^9}, {
   3.674246888420889*^9, 3.674246895607258*^9}, {3.674247641768838*^9, 
   3.674247660839601*^9}, {3.674247773426721*^9, 3.674247783466784*^9}, {
   3.6743009149967623`*^9, 3.674300921554647*^9}, {3.674300973673203*^9, 
   3.67430097394345*^9}, {3.674301296811391*^9, 3.6743013406920033`*^9}, {
   3.674301451197109*^9, 3.674301451346456*^9}, 3.67772879410038*^9, {
   3.677729005055171*^9, 3.677729034475766*^9}, {3.6777339760729094`*^9, 
   3.677734103385478*^9}, {3.677734209130365*^9, 3.6777342159085293`*^9}, {
   3.6777355915273943`*^9, 3.6777355927685957`*^9}, {3.6777989845906057`*^9, 
   3.6777989851006403`*^9}, {3.677799495488874*^9, 3.6777994961768084`*^9}, {
   3.677802316783266*^9, 3.67780234606947*^9}, {3.677802826373724*^9, 
   3.6778028341497793`*^9}, {3.677802917639331*^9, 3.677802924551914*^9}, 
   3.677803127286202*^9, {3.677803182350482*^9, 3.6778031872112226`*^9}, {
   3.677803293025125*^9, 3.677803307101676*^9}, {3.677803414406973*^9, 
   3.677803414769032*^9}, {3.677803482297002*^9, 3.677803491096259*^9}, {
   3.677803675371887*^9, 3.677803677715824*^9}, {3.6778566577725353`*^9, 
   3.677856689810617*^9}, {3.678125642587858*^9, 3.67812570897621*^9}, {
   3.678135801273511*^9, 3.678135802510703*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Markov", " ", "chain", " ", "mean", " ", "passage", " ", "time", " ", 
    "solvers"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Successional", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"exttimeunitstep", "[", 
      RowBox[{"x_", ",", "start_", ",", "U_", ",", "s_", ",", "K_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "M", ",", "lambdas", ",", "mus", ",", "A", ",", "Ainv", ",", "b"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"M", "=", 
         RowBox[{
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Mu]"}], ")"}], "/", "s"}], "]"}], "+", 
          "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lambdas", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"1", "/", "x"}], ",", 
           RowBox[{"M", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mus", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"K", "/", "r"}], 
             RowBox[{"(", 
              RowBox[{"r", "-", 
               RowBox[{"i", " ", "s"}], "-", "\[Mu]"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"i", " ", "s"}], "+", "\[Mu]"}], ")"}], "U", " ", "i", 
             "  ", 
             RowBox[{"s", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"i", " ", "s"}], "+", "\[Mu]", "+", "s"}], ")"}]}]}], 
            ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"A", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{"lambdas", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"lambdas", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "  ", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", "  ", 
           RowBox[{"M", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], "=", 
            RowBox[{"-", 
             RowBox[{"mus", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"lambdas", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"mus", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"-", 
             RowBox[{"lambdas", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "M", "]"}], "]"}], "[", 
          RowBox[{"[", "M", "]"}], "]"}], "=", "1"}], ";", "  ", 
        "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"M", "-", "1"}]}], "]"}], ",", 
           RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LinearSolve", "[", 
          RowBox[{"A", ",", "b"}], "]"}], "[", 
         RowBox[{"[", "start", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Mutiple", " ", "mutations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"exttimeunitstepmm", "[", 
      RowBox[{
      "x_", ",", "start_", ",", "U_", ",", "s_", ",", "K_", ",", "fudge_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "M", ",", "lambdas", ",", "mus", ",", "A", ",", "Ainv", ",", "b"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"M", "=", 
         RowBox[{
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Mu]"}], ")"}], "/", "s"}], "]"}], "+", 
          "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lambdas", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"1", "/", "x"}], ",", 
           RowBox[{"M", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", "i", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"mus", "=", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"fudge", 
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"Log", "[", " ", 
                  RowBox[{
                   RowBox[{"K", "/", "r"}], 
                   RowBox[{"(", 
                    RowBox[{"r", "-", "\[Mu]", "-", 
                    RowBox[{"i", " ", "s"}]}], ")"}], "s"}], "]"}]}], "-", 
                RowBox[{"Log", "[", " ", 
                 RowBox[{"s", "/", 
                  RowBox[{"(", 
                   RowBox[{"U", " ", "i"}], ")"}]}], "]"}]}], ")"}], 
              RowBox[{"s", "/", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Log", "[", 
                  RowBox[{"s", "/", 
                   RowBox[{"(", 
                    RowBox[{"U", " ", "i"}], ")"}]}], "]"}], ")"}], "^", 
                "2"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ",", "0"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"A", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{"lambdas", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"lambdas", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "  ", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", "  ", 
           RowBox[{"M", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], "=", 
            RowBox[{"-", 
             RowBox[{"mus", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"lambdas", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"mus", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"-", 
             RowBox[{"lambdas", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "M", "]"}], "]"}], "[", 
          RowBox[{"[", "M", "]"}], "]"}], "=", "1"}], ";", "  ", 
        "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"M", "-", "1"}]}], "]"}], ",", 
           RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LinearSolve", "[", 
          RowBox[{"A", ",", "b"}], "]"}], "[", 
         RowBox[{"[", "start", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Regular", " ", "mutant", " ", "establishment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"exttimefixedmutation", "[", 
      RowBox[{
      "x_", ",", "start_", ",", "U_", ",", "s_", ",", "K_", ",", "fudge_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", ",", "A", ",", "b", ",", "poiss", ",", "tmut"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"M", "=", 
         RowBox[{
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Mu]"}], ")"}], "/", "s"}], "]"}], "+", 
          "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"A", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmut", "[", "i_", "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"s", "/", 
             RowBox[{"(", 
              RowBox[{"U", " ", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], ")"}]}], "]"}], "^", "2"}], 
          "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"Log", "[", " ", 
                RowBox[{
                 RowBox[{"K", "/", "r"}], 
                 RowBox[{"(", 
                  RowBox[{"r", "-", "\[Mu]", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "s"}]}], ")"}], 
                 "s"}], "]"}]}], "-", 
              RowBox[{"Log", "[", " ", 
               RowBox[{"s", "/", 
                RowBox[{"(", 
                 RowBox[{"U", " ", 
                  RowBox[{"(", 
                   RowBox[{"i", "-", "1"}], ")"}]}], ")"}]}], "]"}]}], ")"}], 
            "s", " ", "fudge"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", "  ", 
           RowBox[{"M", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"poiss", "[", "k_", "]"}], ":=", 
            RowBox[{"PDF", "[", 
             RowBox[{
              RowBox[{"PoissonDistribution", "[", 
               RowBox[{
                RowBox[{"tmut", "[", "i", "]"}], "/", "x"}], "]"}], ",", 
              "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ";;", 
               RowBox[{"M", "-", "1"}]}], "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"poiss", "[", "j", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "0", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"M", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "M", "]"}], "]"}], "=", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Total", "[", 
                RowBox[{"A", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ")"}]}]}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", "1"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"poiss", "[", "k_", "]"}], "=", 
         RowBox[{"PDF", "[", 
          RowBox[{
           RowBox[{"PoissonDistribution", "[", 
            RowBox[{
             RowBox[{"tmut", "[", "2", "]"}], "/", "x"}], "]"}], ",", "k"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"poiss", "[", "0", "]"}]}], "-", 
          RowBox[{"poiss", "[", "1", "]"}]}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", 
            RowBox[{"M", "-", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"poiss", "[", "j", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", 
             RowBox[{"(", 
              RowBox[{"M", "-", "1"}], ")"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "M", "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Total", "[", 
             RowBox[{"A", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "M", "]"}], "]"}], "[", 
          RowBox[{"[", "M", "]"}], "]"}], "=", "1"}], ";", "  ", 
        "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tmut", "[", "2", "]"}], "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"tmut", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2", ",", 
               RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LinearSolve", "[", 
          RowBox[{"A", ",", "b"}], "]"}], "[", 
         RowBox[{"[", "start", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6352833889765205`*^9, 3.635283466278942*^9}, {
   3.635283547430584*^9, 3.635283586953844*^9}, {3.6352836963020983`*^9, 
   3.635283739245555*^9}, {3.6352838431834993`*^9, 3.635283863761677*^9}, {
   3.6352839522587385`*^9, 3.6352840281870813`*^9}, {3.635284060404924*^9, 
   3.635284106797578*^9}, {3.635284154287294*^9, 3.6352841560673957`*^9}, {
   3.635284255495083*^9, 3.635284431102127*^9}, {3.635284518157106*^9, 
   3.6352846806504*^9}, {3.635284720250665*^9, 3.63528475145745*^9}, {
   3.635284798577145*^9, 3.63528485093814*^9}, {3.635284924471346*^9, 
   3.6352849322957935`*^9}, {3.63528496336557*^9, 3.6352849634495754`*^9}, {
   3.635284995629416*^9, 3.6352850062180214`*^9}, {3.6352850492774844`*^9, 
   3.6352850867906303`*^9}, {3.6352851202765455`*^9, 3.635285156131596*^9}, {
   3.63528537805929*^9, 3.6352854572208176`*^9}, {3.635285502491407*^9, 
   3.6352855703012853`*^9}, {3.6352856181310205`*^9, 3.635285618602048*^9}, {
   3.6352911481964903`*^9, 3.635291160325184*^9}, {3.635291850079635*^9, 
   3.635291850614666*^9}, {3.6352945866091557`*^9, 3.6352946049972076`*^9}, {
   3.6352947527326574`*^9, 3.6352947889917316`*^9}, {3.6352948286810017`*^9, 
   3.635294828793008*^9}, {3.6352948589987354`*^9, 3.6352948930016804`*^9}, {
   3.6352970886482644`*^9, 3.635297091673437*^9}, 3.6352972629782352`*^9, {
   3.6352987290780916`*^9, 3.6352987340923786`*^9}, 3.6352991720984306`*^9, 
   3.635340741199876*^9, {3.635475932062402*^9, 3.6354759443941073`*^9}, {
   3.635476328563081*^9, 3.635476329501134*^9}, 3.635775605574087*^9, {
   3.6357764150333853`*^9, 3.6357764365196147`*^9}, {3.635776570202261*^9, 
   3.6357765925405383`*^9}, {3.635776627932563*^9, 3.6357766334188766`*^9}, {
   3.6357771306273155`*^9, 3.635777149989423*^9}, {3.6357772098678474`*^9, 
   3.6357772497801304`*^9}, {3.6357773735132074`*^9, 3.635777394497408*^9}, {
   3.6375933797266035`*^9, 3.637593380584653*^9}, 3.637604775683031*^9, 
   3.637604872291557*^9, {3.6376103952184505`*^9, 3.6376104006247597`*^9}, {
   3.6376104456773367`*^9, 3.6376104619752684`*^9}, 3.6421821940496855`*^9, 
   3.6421895528855867`*^9, {3.643632107170277*^9, 3.643632159632278*^9}, {
   3.6436322024747286`*^9, 3.643632238130768*^9}, {3.6436326589018345`*^9, 
   3.6436326604919252`*^9}, {3.6436345577624435`*^9, 
   3.6436345681880393`*^9}, {3.6436346171428394`*^9, 3.643634625979345*^9}, {
   3.6436349672158623`*^9, 3.6436349673348694`*^9}, {3.6436387593417597`*^9, 
   3.6436387594617662`*^9}, {3.6436402919394193`*^9, 3.643640305537197*^9}, {
   3.643652707018601*^9, 3.6436527128849363`*^9}, {3.643652757153468*^9, 
   3.6436527601316385`*^9}, {3.643652794211588*^9, 3.643652817359912*^9}, {
   3.643898292148797*^9, 3.643898309992818*^9}, {3.6439710230908146`*^9, 
   3.6439710514484367`*^9}, {3.643971094834918*^9, 3.6439711302329426`*^9}, {
   3.6439750571643014`*^9, 3.643975113852544*^9}, {3.644092255306752*^9, 
   3.644092267244435*^9}, {3.6440923991829815`*^9, 3.6440924093825645`*^9}, {
   3.644092996886168*^9, 3.6440930043445945`*^9}, {3.6441189844911804`*^9, 
   3.644119001491153*^9}, {3.6441224230618553`*^9, 3.6441224308313*^9}, {
   3.644146832649168*^9, 3.6441468805109053`*^9}, {3.644148098509571*^9, 
   3.644148098822589*^9}, {3.644160266121645*^9, 3.6441602662136507`*^9}, {
   3.6441620463524685`*^9, 3.6441620591432*^9}, {3.644244087332764*^9, 
   3.6442441008825393`*^9}, {3.644244186250422*^9, 3.6442441898686285`*^9}, {
   3.6442453665429306`*^9, 3.64424537719654*^9}, {3.6442464428344913`*^9, 
   3.644246444233571*^9}, 3.644249486447576*^9, {3.6442532467082043`*^9, 
   3.644253250223405*^9}, {3.644893555587338*^9, 3.64489355702242*^9}, {
   3.6448935924154444`*^9, 3.6448935943435545`*^9}, {3.6448944584159765`*^9, 
   3.6448944590830154`*^9}, {3.644894628178687*^9, 3.6448946507919803`*^9}, {
   3.6448946849199324`*^9, 3.644894688936162*^9}, {3.64489508228866*^9, 
   3.6448950843937807`*^9}, {3.6448953499009666`*^9, 
   3.6448953543692226`*^9}, {3.6448953919543724`*^9, 3.644895407787278*^9}, {
   3.644897457832534*^9, 3.6448975453185377`*^9}, {3.6448982766203656`*^9, 
   3.6448983557888937`*^9}, {3.645406851934989*^9, 3.6454068540401096`*^9}, {
   3.658494210097858*^9, 3.658494279228109*^9}, {3.658494531405542*^9, 
   3.6584945383182707`*^9}, {3.658495821373365*^9, 3.658495821626741*^9}, {
   3.658693549340126*^9, 3.65869354945504*^9}, {3.658758941520281*^9, 
   3.658758941603231*^9}, {3.659119423944435*^9, 3.659119440157064*^9}, {
   3.659119539002328*^9, 3.6591195532942963`*^9}, {3.659187245148505*^9, 
   3.659187331011348*^9}, 3.659187717560467*^9, {3.659187787169118*^9, 
   3.659187853817614*^9}, {3.659207104524444*^9, 3.659207151750296*^9}, {
   3.659207182010744*^9, 3.659207200897809*^9}, {3.659207295408064*^9, 
   3.659207299765367*^9}, {3.659208989750402*^9, 3.6592090230869093`*^9}, {
   3.659209100237586*^9, 3.6592091153406878`*^9}, {3.659209161383123*^9, 
   3.659209232255517*^9}, {3.659209415755114*^9, 3.659209419327372*^9}, {
   3.659209454615581*^9, 3.6592094824898663`*^9}, {3.659209565883088*^9, 
   3.659209602813664*^9}, {3.659209765033237*^9, 3.659209767821991*^9}, 
   3.6592986739128237`*^9, {3.659298787371058*^9, 3.659298852859214*^9}, {
   3.659298914471422*^9, 3.659298931333893*^9}, 3.659357519606991*^9, 
   3.65935881777182*^9, {3.6593588901864223`*^9, 3.659358891473071*^9}, 
   3.6593597383344297`*^9, {3.6593603948515997`*^9, 3.6593603952611237`*^9}, {
   3.659360714633738*^9, 3.6593607237280617`*^9}, {3.659360875939581*^9, 
   3.659360911460683*^9}, 3.659360945269754*^9, 3.659363068506241*^9, {
   3.659363204201643*^9, 3.659363215355068*^9}, 3.659363342208112*^9, {
   3.659363509609673*^9, 3.659363509742475*^9}, 3.659363560463706*^9, {
   3.6593659699109163`*^9, 3.659365985911257*^9}, {3.660878626925223*^9, 
   3.6608786297933865`*^9}, {3.6609595141848497`*^9, 
   3.6609595261715355`*^9}, {3.6609611812291994`*^9, 3.660961181330205*^9}, {
   3.660961673778372*^9, 3.660961675255456*^9}, {3.660961720312033*^9, 
   3.660961730887638*^9}, {3.660961766953701*^9, 3.660961812530308*^9}, {
   3.660961922263584*^9, 3.660961922343589*^9}, {3.660961971859421*^9, 
   3.6609619871192937`*^9}, {3.6609686245519333`*^9, 3.660968637347665*^9}, {
   3.6609687465219097`*^9, 3.6609689248671103`*^9}, {3.6609690309081755`*^9, 
   3.660969115223998*^9}, {3.660969153464185*^9, 3.660969165996902*^9}, {
   3.6609692139076424`*^9, 3.6609692596082563`*^9}, {3.660971652364422*^9, 
   3.66097173834334*^9}, {3.6609719073480062`*^9, 3.66097194255802*^9}, {
   3.6609720034015007`*^9, 3.660972035757351*^9}, {3.660972088997396*^9, 
   3.660972091918563*^9}, {3.660972143667523*^9, 3.6609721442095537`*^9}, {
   3.660972175236329*^9, 3.66097217875753*^9}, 3.6609724103667774`*^9, {
   3.6609724440927067`*^9, 3.6609725069503016`*^9}, {3.660972538730119*^9, 
   3.660972539126142*^9}, 3.6609726069170194`*^9, {3.6609726560958323`*^9, 
   3.6609726562118387`*^9}, {3.66097270500863*^9, 3.660972710939969*^9}, {
   3.660972775453659*^9, 3.660972831353856*^9}, {3.660979317185003*^9, 
   3.6609793263935294`*^9}, {3.6609798678815007`*^9, 3.660979872792782*^9}, {
   3.6609799933216753`*^9, 3.6609799935346875`*^9}, {3.661023313096892*^9, 
   3.661023368497061*^9}, {3.661023428293481*^9, 3.6610234311536446`*^9}, {
   3.6610303171395*^9, 3.6610303213177395`*^9}, {3.6610304722573724`*^9, 
   3.6610304885343037`*^9}, {3.661030552801979*^9, 3.661030563971618*^9}, {
   3.661030594721377*^9, 3.661030625110115*^9}, {3.661031179002796*^9, 
   3.661031186913248*^9}, {3.661031271880108*^9, 3.6610312742482433`*^9}, {
   3.6610315150290155`*^9, 3.661031550344035*^9}, {3.662173899836521*^9, 
   3.6621739050078173`*^9}, {3.66217759776303*^9, 3.662177597862036*^9}, {
   3.664112984638772*^9, 3.664112988240806*^9}, {3.664541823550191*^9, 
   3.66454183584921*^9}, {3.6645438788544292`*^9, 3.664543878936214*^9}, {
   3.678037134188012*^9, 3.6780371532813797`*^9}}]
},
WindowSize->{1918, 1027},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 386, 8, 37, "Input"],
Cell[947, 30, 13473, 264, 701, "Input"],
Cell[14423, 296, 8825, 162, 327, "Input"],
Cell[23251, 460, 8762, 216, 905, "Input"],
Cell[32016, 678, 1260, 31, 245, "Input"],
Cell[33279, 711, 3415, 74, 519, "Input"],
Cell[36697, 787, 68878, 1274, 3441, "Input"],
Cell[105578, 2063, 24963, 569, 1220, "Input"]
}
]
*)

(* End of internal cache information *)
